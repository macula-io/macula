%% Macula Hybrid Mode Configuration
%% Purpose: Well-known entry point + relay capability (infrastructure node)
%%
%% Hybrid nodes provide:
%% - DHT bootstrap and peer discovery
%% - Service registry
%% - Gateway relay for NAT-ed peers
%% - Health monitoring
%%
%% Typical use case: Public-facing infrastructure node
%% Example: bootstrap.macula.io â†’ Hybrid node (discovery + relay)

[
    {macula, [
        %% Deployment mode
        {mode, hybrid},

        %% Both bootstrap and gateway enabled
        {start_gateway, true},

        %% Bootstrap configuration
        {realm, <<"macula.global">>},
        {bootstrap_health_interval, 30000},

        %% Gateway configuration
        {gateway_port, 9443},
        {health_port, 8080},

        %% DHT configuration
        {dht_k, 20},
        {dht_alpha, 3},

        %% Gateway limits (higher for infrastructure nodes)
        {max_clients, 50000},          % Higher limit for public nodes
        {max_mesh_connections, 5000},  % Larger mesh pool
        {connection_timeout, 300000},

        %% RPC configuration
        {rpc_timeout, 5000},
        {rpc_max_hops, 10},

        %% Pub/Sub configuration
        {pubsub_max_hops, 10},
        {pubsub_qos, 0}
    ]},

    {kernel, [
        {logger_level, info},
        {logger, [
            {handler, default, logger_std_h, #{
                formatter => {logger_formatter, #{
                    single_line => true,
                    template => [time, " [", level, "] ", msg, "\n"]
                }}
            }}
        ]}
    ]},

    {sasl, [
        {sasl_error_logger, false}
    ]}
].
