%% Macula Edge Mode Configuration
%% Purpose: Pure P2P peer with direct communication
%%
%% Edge nodes provide:
%% - Pure P2P messaging (RPC, pub/sub)
%% - DHT-routed communication (no gateway relay)
%% - Local service advertisement
%%
%% Edge nodes do NOT:
%% - Act as bootstrap nodes (connect to bootstrap instead)
%% - Relay messages for other peers (pure P2P)

[
    {macula, [
        %% Deployment mode
        {mode, edge},

        %% Gateway disabled (pure P2P)
        {start_gateway, false},

        %% Bootstrap nodes for DHT discovery
        %% Format: <<"host:port">> or <<"ip:port">>
        {bootstrap_nodes, [
            <<"bootstrap.macula.io:9443">>,
            <<"bootstrap-backup.macula.io:9443">>
        ]},

        %% Realm for this edge node
        {realm, <<"macula.edge">>},

        %% DHT configuration
        {dht_k, 20},        % Kademlia K parameter (bucket size)
        {dht_alpha, 3},     % Concurrent DHT queries

        %% RPC configuration
        {rpc_timeout, 5000},           % Default RPC timeout (5 seconds)
        {rpc_max_hops, 10},            % Max DHT routing hops

        %% Pub/Sub configuration
        {pubsub_max_hops, 10},         % Max DHT routing hops
        {pubsub_qos, 0}                % Default QoS (0 = at most once)
    ]},

    {kernel, [
        {logger_level, info},
        {logger, [
            {handler, default, logger_std_h, #{
                formatter => {logger_formatter, #{
                    single_line => true,
                    template => [time, " [", level, "] ", msg, "\n"]
                }}
            }}
        ]}
    ]},

    {sasl, [
        {sasl_error_logger, false}
    ]}
].
