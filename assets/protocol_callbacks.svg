<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600" width="800" height="600">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6366f1"/>
    </marker>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4f46e5"/>
      <stop offset="100%" style="stop-color:#6366f1"/>
    </linearGradient>
    <linearGradient id="identityGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#059669"/>
      <stop offset="100%" style="stop-color:#10b981"/>
    </linearGradient>
    <linearGradient id="capGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#0891b2"/>
      <stop offset="100%" style="stop-color:#22d3ee"/>
    </linearGradient>
    <linearGradient id="handlerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#c026d3"/>
      <stop offset="100%" style="stop-color:#e879f9"/>
    </linearGradient>
    <linearGradient id="healthGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#dc2626"/>
      <stop offset="100%" style="stop-color:#f87171"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="800" height="600" fill="#0f172a"/>

  <!-- Title -->
  <text x="400" y="40" fill="#f1f5f9" font-family="system-ui, sans-serif" font-size="24" font-weight="bold" text-anchor="middle">macula_protocol Behaviour Callbacks</text>
  <text x="400" y="65" fill="#94a3b8" font-family="system-ui, sans-serif" font-size="14" text-anchor="middle">Required callbacks for mesh-worthy applications</text>

  <!-- Central App Box -->
  <rect x="300" y="250" width="200" height="100" rx="10" fill="url(#headerGrad)" stroke="#818cf8" stroke-width="2"/>
  <text x="400" y="290" fill="#fff" font-family="monospace" font-size="16" font-weight="bold" text-anchor="middle">Your App Module</text>
  <text x="400" y="315" fill="#c7d2fe" font-family="monospace" font-size="12" text-anchor="middle">-behaviour(macula_protocol).</text>

  <!-- Identity Callbacks (top left) -->
  <rect x="40" y="90" width="200" height="90" rx="8" fill="#1e293b" stroke="#10b981" stroke-width="2"/>
  <rect x="40" y="90" width="200" height="30" rx="8" fill="url(#identityGrad)"/>
  <text x="140" y="112" fill="#fff" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Identity</text>
  <text x="50" y="140" fill="#d1d5db" font-family="monospace" font-size="11">mesh_identity/0</text>
  <text x="50" y="160" fill="#6b7280" font-family="monospace" font-size="10">-&gt; binary()</text>
  <line x1="200" y1="150" x2="300" y2="280" stroke="#10b981" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Capabilities Callbacks (top right) -->
  <rect x="560" y="90" width="200" height="90" rx="8" fill="#1e293b" stroke="#22d3ee" stroke-width="2"/>
  <rect x="560" y="90" width="200" height="30" rx="8" fill="url(#capGrad)"/>
  <text x="660" y="112" fill="#fff" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Capabilities</text>
  <text x="570" y="140" fill="#d1d5db" font-family="monospace" font-size="11">mesh_capabilities/0</text>
  <text x="570" y="160" fill="#6b7280" font-family="monospace" font-size="10">-&gt; [capability()]</text>
  <line x1="600" y1="150" x2="500" y2="280" stroke="#22d3ee" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- API Spec (left side) -->
  <rect x="40" y="220" width="200" height="90" rx="8" fill="#1e293b" stroke="#818cf8" stroke-width="2"/>
  <rect x="40" y="220" width="200" height="30" rx="8" fill="url(#headerGrad)"/>
  <text x="140" y="242" fill="#fff" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">API Spec</text>
  <text x="50" y="270" fill="#d1d5db" font-family="monospace" font-size="11">mesh_api/0</text>
  <text x="50" y="290" fill="#6b7280" font-family="monospace" font-size="10">-&gt; api_spec()</text>
  <line x1="240" y1="265" x2="300" y2="290" stroke="#818cf8" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Event Handler (bottom left) -->
  <rect x="40" y="380" width="200" height="110" rx="8" fill="#1e293b" stroke="#e879f9" stroke-width="2"/>
  <rect x="40" y="380" width="200" height="30" rx="8" fill="url(#handlerGrad)"/>
  <text x="140" y="402" fill="#fff" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Event Handlers</text>
  <text x="50" y="430" fill="#d1d5db" font-family="monospace" font-size="11">handle_mesh_event/2</text>
  <text x="50" y="450" fill="#d1d5db" font-family="monospace" font-size="11">handle_rpc_call/2</text>
  <text x="50" y="470" fill="#6b7280" font-family="monospace" font-size="10">-&gt; ok | {ok, term()}</text>
  <line x1="200" y1="420" x2="300" y2="330" stroke="#e879f9" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Content Transfer (bottom center) -->
  <rect x="300" y="400" width="200" height="110" rx="8" fill="#1e293b" stroke="#fbbf24" stroke-width="2"/>
  <rect x="300" y="400" width="200" height="30" rx="8" fill="#d97706"/>
  <text x="400" y="422" fill="#fff" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Content Transfer</text>
  <text x="310" y="450" fill="#d1d5db" font-family="monospace" font-size="11">provide_content/1</text>
  <text x="310" y="470" fill="#d1d5db" font-family="monospace" font-size="11">content_received/2</text>
  <text x="310" y="490" fill="#6b7280" font-family="monospace" font-size="10">-&gt; {ok, binary()} | ok</text>
  <line x1="400" y1="400" x2="400" y2="350" stroke="#fbbf24" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Health Check (bottom right) -->
  <rect x="560" y="380" width="200" height="90" rx="8" fill="#1e293b" stroke="#f87171" stroke-width="2"/>
  <rect x="560" y="380" width="200" height="30" rx="8" fill="url(#healthGrad)"/>
  <text x="660" y="402" fill="#fff" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Health</text>
  <text x="570" y="430" fill="#d1d5db" font-family="monospace" font-size="11">mesh_health/0</text>
  <text x="570" y="450" fill="#6b7280" font-family="monospace" font-size="10">-&gt; ok | {error, term()}</text>
  <line x1="600" y1="420" x2="500" y2="330" stroke="#f87171" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Capability Legend -->
  <rect x="560" y="210" width="200" height="140" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
  <text x="660" y="235" fill="#94a3b8" font-family="system-ui, sans-serif" font-size="12" font-weight="bold" text-anchor="middle">Valid Capabilities</text>
  <text x="570" y="260" fill="#22d3ee" font-family="monospace" font-size="11">publish</text>
  <text x="570" y="280" fill="#22d3ee" font-family="monospace" font-size="11">subscribe</text>
  <text x="570" y="300" fill="#22d3ee" font-family="monospace" font-size="11">call</text>
  <text x="680" y="260" fill="#22d3ee" font-family="monospace" font-size="11">register</text>
  <text x="680" y="280" fill="#22d3ee" font-family="monospace" font-size="11">provide_content</text>
  <text x="680" y="300" fill="#22d3ee" font-family="monospace" font-size="11">consume_content</text>

  <!-- Footer -->
  <text x="400" y="560" fill="#64748b" font-family="system-ui, sans-serif" font-size="12" text-anchor="middle">All callbacks must be implemented for mesh admission</text>
  <text x="400" y="580" fill="#475569" font-family="system-ui, sans-serif" font-size="10" text-anchor="middle">See: macula_protocol.erl for type definitions</text>
</svg>
