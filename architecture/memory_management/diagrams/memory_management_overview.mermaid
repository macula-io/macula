graph TD
    A[Macula Platform] --> B[Gateway Layer]
    A --> C[Service Layer]
    A --> D[Application Layer]

    B --> E[mesh: Bounded Pool<br/>max 1,000<br/>LRU eviction]
    B --> F[client_manager: Client Limits<br/>max 10,000<br/>backpressure]
    B --> G[client_manager: Stream Cleanup<br/>coordinated maps]

    C --> H[service_registry: TTL Cleanup<br/>300s expiry]
    C --> I[advertisement_manager: Periodic Cleanup<br/>60s interval]

    D --> J[rpc_handler: Caller Monitoring<br/>immediate cleanup]

    style E fill:#90EE90
    style F fill:#90EE90
    style G fill:#90EE90
    style H fill:#87CEEB
    style I fill:#87CEEB
    style J fill:#FFB6C1
