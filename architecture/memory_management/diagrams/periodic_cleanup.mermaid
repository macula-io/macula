stateDiagram-v2
    [*] --> Init: advertisement_manager starts
    Init --> Scheduled: erlang:send_after(60000, cleanup_expired_services)

    Scheduled --> Running: Timer fires
    Running --> CheckExpiry: Call prune_expired_local_services/1

    CheckExpiry --> LogInfo: RemovedCount > 0
    CheckExpiry --> LogDebug: RemovedCount = 0

    LogInfo --> Reschedule: Log "removed N services"
    LogDebug --> Reschedule: Log "no expired services"

    Reschedule --> Scheduled: erlang:send_after(60000, cleanup_expired_services)

    note right of Scheduled
        Cleanup runs every 60 seconds
        Services older than 300s removed
    end note
