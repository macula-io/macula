<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="macula v0.7.7">


    <title>Project Structure — macula v0.7.7</title>

    <link rel="stylesheet" href="dist/html-erlang-DQDXQC7W.css" />

    <script defer src="dist/sidebar_items-62100C5B.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="hello_world.html" class="sidebar-projectImage">
          <img src="assets/logo.svg" alt="macula" />
        </a>

      <div>
        <a href="hello_world.html" class="sidebar-projectName" translate="no">
macula
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.7.7
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of macula</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Macula HTTP/3 Mesh - Project Structure and Libraries</h1>


      <a href="https://github.com/macula-io/macula/blob/0.7.7/architecture/MACULA_PROJECT_STRUCTURE.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p><strong>Actual Erlang/Elixir projects and libraries to build</strong></p><p><strong>Created</strong>: 2025-01-08
<strong>Status</strong>: Planning Document</p><hr class="thin"/><h2 id="overview" class="section-heading"><a href="#overview" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Overview</span></h2><p>This document outlines the actual Erlang/Elixir libraries, applications, and projects that need to be created to implement the Macula HTTP/3 Mesh platform.</p><hr class="thin"/><h2 id="repository-organization-strategy" class="section-heading"><a href="#repository-organization-strategy" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Repository Organization Strategy</span></h2><h3 id="option-a-monorepo-recommended-for-initial-development" class="section-heading"><a href="#option-a-monorepo-recommended-for-initial-development" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Option A: Monorepo (Recommended for Initial Development)</span></h3><pre><code class="makeup erlang" translate="no"><span class="ss">macula</span><span class="o">/</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">apps</span><span class="o">/</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_core</span><span class="o">/</span><span class="w">           </span><span class="p">#</span><span class="w"> </span><span class="n">Core</span><span class="w"> </span><span class="ss">protocols</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">types</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_quic</span><span class="o">/</span><span class="w">           </span><span class="p">#</span><span class="w"> </span><span class="n">QUIC</span><span class="w"> </span><span class="ss">transport</span><span class="w"> </span><span class="ss">layer</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_protocol</span><span class="o">/</span><span class="w">       </span><span class="p">#</span><span class="w"> </span><span class="n">Wire</span><span class="w"> </span><span class="nf">protocol</span><span class="w"> </span><span class="p" data-group-id="2099941161-1">(</span><span class="ss">framing</span><span class="p">,</span><span class="w"> </span><span class="ss">encoding</span><span class="p" data-group-id="2099941161-1">)</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_membership</span><span class="o">/</span><span class="w">     </span><span class="p">#</span><span class="w"> </span><span class="n">SWIM</span><span class="w"> </span><span class="ss">membership</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_routing</span><span class="o">/</span><span class="w">        </span><span class="p">#</span><span class="w"> </span><span class="n">Kademlia</span><span class="w"> </span><span class="n">DHT</span><span class="w"> </span><span class="ss">routing</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_topology</span><span class="o">/</span><span class="w">       </span><span class="p">#</span><span class="w"> </span><span class="n">Mesh</span><span class="w"> </span><span class="ss">topology</span><span class="w"> </span><span class="ss">management</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_pubsub</span><span class="o">/</span><span class="w">         </span><span class="p">#</span><span class="w"> </span><span class="n">Pub</span><span class="o">/</span><span class="ss">sub</span><span class="w"> </span><span class="ss">implementation</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_rpc</span><span class="o">/</span><span class="w">            </span><span class="p">#</span><span class="w"> </span><span class="n">RPC</span><span class="w"> </span><span class="ss">implementation</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_gateway</span><span class="o">/</span><span class="w">        </span><span class="p">#</span><span class="w"> </span><span class="n">Cross</span><span class="o">-</span><span class="ss">realm</span><span class="w"> </span><span class="ss">gateway</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_discovery</span><span class="o">/</span><span class="w">      </span><span class="p">#</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="ss">discovery</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_security</span><span class="o">/</span><span class="w">       </span><span class="p">#</span><span class="w"> </span><span class="n">Auth</span><span class="p">,</span><span class="w"> </span><span class="n">ACLs</span><span class="p">,</span><span class="w"> </span><span class="ss">certificates</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula</span><span class="o">/</span><span class="w">                </span><span class="p">#</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="nf">application</span><span class="w"> </span><span class="p" data-group-id="2099941161-2">(</span><span class="ss">umbrella</span><span class="p" data-group-id="2099941161-2">)</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">rebar</span><span class="p">.</span><span class="ss">config</span><span class="w">               </span><span class="p">#</span><span class="w"> </span><span class="n">Rebar3</span><span class="w"> </span><span class="ss">umbrella</span><span class="w"> </span><span class="ss">config</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">mix</span><span class="p">.</span><span class="ss">exs</span><span class="w">                    </span><span class="p">#</span><span class="w"> </span><span class="n">Mix</span><span class="w"> </span><span class="ss">umbrella</span><span class="w"> </span><span class="nf">config</span><span class="w"> </span><span class="p" data-group-id="2099941161-3">(</span><span class="k">if</span><span class="w"> </span><span class="ss">supporting</span><span class="w"> </span><span class="n">Elixir</span><span class="p" data-group-id="2099941161-3">)</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">README</span><span class="p">.</span><span class="ss">md</span></code></pre><p><strong>Benefits</strong>:</p><ul><li>Easy cross-library development</li><li>Shared dependencies</li><li>Single release</li><li>Atomic commits across components</li><li>Simplified CI/CD</li></ul><h3 id="option-b-multi-repo-for-maturity-modularity" class="section-heading"><a href="#option-b-multi-repo-for-maturity-modularity" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Option B: Multi-repo (For Maturity/Modularity)</span></h3><p>Separate repositories for each library (similar to Erlang/OTP structure).</p><p><strong>Benefits</strong>:</p><ul><li>Independent versioning</li><li>Smaller, focused repos</li><li>Can use different libraries independently</li><li>Clear boundaries</li></ul><p><strong>Recommendation</strong>: Start with <strong>Option A (monorepo)</strong>, split later if needed.</p><hr class="thin"/><h2 id="core-libraries-required-for-mvp" class="section-heading"><a href="#core-libraries-required-for-mvp" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Core Libraries (Required for MVP)</span></h2><h3 id="1-macula_core" class="section-heading"><a href="#1-macula_core" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">1. <code class="inline">macula_core</code></span></h3><p><strong>Purpose</strong>: Core types, protocols, and shared utilities.</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Core types</span><span class="w">
</span><span class="ss">macula_types</span><span class="p">.</span><span class="ss">erl</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">Common</span><span class="w"> </span><span class="ss">type</span><span class="w"> </span><span class="ss">definitions</span><span class="w">
</span><span class="ss">macula_node</span><span class="p">.</span><span class="ss">erl</span><span class="w">            </span><span class="o">-</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="ss">identity</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">metadata</span><span class="w">
</span><span class="ss">macula_realm</span><span class="p">.</span><span class="ss">erl</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">Realm</span><span class="w"> </span><span class="ss">management</span><span class="w">
</span><span class="ss">macula_topic</span><span class="p">.</span><span class="ss">erl</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">Topic</span><span class="w"> </span><span class="ss">parsing</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">validation</span><span class="w">

</span><span class="c1">%% Utilities</span><span class="w">
</span><span class="ss">macula_time</span><span class="p">.</span><span class="ss">erl</span><span class="w">            </span><span class="o">-</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="ss">utilities</span><span class="w">
</span><span class="ss">macula_id</span><span class="p">.</span><span class="ss">erl</span><span class="w">              </span><span class="o">-</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="nf">generation</span><span class="w"> </span><span class="p" data-group-id="6185863307-1">(</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="w"> </span><span class="nb">node</span><span class="w"> </span><span class="n">IDs</span><span class="p" data-group-id="6185863307-1">)</span><span class="w">
</span><span class="ss">macula_uri</span><span class="p">.</span><span class="ss">erl</span><span class="w">             </span><span class="o">-</span><span class="w"> </span><span class="n">Macula</span><span class="w"> </span><span class="n">URI</span><span class="w"> </span><span class="nf">parsing</span><span class="w"> </span><span class="p" data-group-id="6185863307-2">(</span><span class="nc">macula</span><span class="p">:</span><span class="o">/</span><span class="o">/</span><span class="ss">realm</span><span class="o">/</span><span class="nb">node</span><span class="p" data-group-id="6185863307-2">)</span></code></pre><p><strong>Dependencies</strong>: None (pure Erlang)</p><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="4966816458-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4966816458-2">[</span><span class="w">
    </span><span class="p" data-group-id="4966816458-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula core types and protocols&quot;</span><span class="p" data-group-id="4966816458-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4966816458-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="4966816458-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4966816458-5">{</span><span class="ss">modules</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4966816458-6">[</span><span class="p" data-group-id="4966816458-6">]</span><span class="p" data-group-id="4966816458-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4966816458-7">{</span><span class="ss">registered</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4966816458-8">[</span><span class="p" data-group-id="4966816458-8">]</span><span class="p" data-group-id="4966816458-7">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4966816458-9">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4966816458-10">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p" data-group-id="4966816458-10">]</span><span class="p" data-group-id="4966816458-9">}</span><span class="w">
</span><span class="p" data-group-id="4966816458-2">]</span><span class="p" data-group-id="4966816458-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="2-macula_quic" class="section-heading"><a href="#2-macula_quic" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">2. <code class="inline">macula_quic</code></span></h3><p><strong>Purpose</strong>: QUIC transport layer (wrapper around quicer).</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_quic_listener</span><span class="p">.</span><span class="ss">erl</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">QUIC</span><span class="w"> </span><span class="nf">listener</span><span class="w"> </span><span class="p" data-group-id="1428213896-1">(</span><span class="ss">accept</span><span class="w"> </span><span class="ss">connections</span><span class="p" data-group-id="1428213896-1">)</span><span class="w">
</span><span class="ss">macula_quic_client</span><span class="p">.</span><span class="ss">erl</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">QUIC</span><span class="w"> </span><span class="nf">client</span><span class="w"> </span><span class="p" data-group-id="1428213896-2">(</span><span class="ss">initiate</span><span class="w"> </span><span class="ss">connections</span><span class="p" data-group-id="1428213896-2">)</span><span class="w">
</span><span class="ss">macula_quic_connection</span><span class="p">.</span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">GenServer</span><span class="w"> </span><span class="ss">per</span><span class="w"> </span><span class="n">QUIC</span><span class="w"> </span><span class="ss">connection</span><span class="w">
</span><span class="ss">macula_quic_stream</span><span class="p">.</span><span class="ss">erl</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="ss">management</span><span class="w">
</span><span class="ss">macula_quic_config</span><span class="p">.</span><span class="ss">erl</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">QUIC</span><span class="w"> </span><span class="nf">configuration</span><span class="w"> </span><span class="p" data-group-id="1428213896-3">(</span><span class="n">TLS</span><span class="p">,</span><span class="w"> </span><span class="n">ALPN</span><span class="p">,</span><span class="w"> </span><span class="ss">etc</span><span class="p">.</span><span class="p" data-group-id="1428213896-3">)</span></code></pre><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">quicer</code> (NIF for MsQuic)</li></ul><p><strong>Key Features</strong>:</p><ul><li>Connection pooling</li><li>Stream multiplexing</li><li>0-RTT support</li><li>Connection migration</li><li>Backpressure handling</li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="9747643884-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_quic</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9747643884-2">[</span><span class="w">
    </span><span class="p" data-group-id="9747643884-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula QUIC transport layer&quot;</span><span class="p" data-group-id="9747643884-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9747643884-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="9747643884-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9747643884-5">{</span><span class="ss">modules</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9747643884-6">[</span><span class="p" data-group-id="9747643884-6">]</span><span class="p" data-group-id="9747643884-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9747643884-7">{</span><span class="ss">registered</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9747643884-8">[</span><span class="p" data-group-id="9747643884-8">]</span><span class="p" data-group-id="9747643884-7">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9747643884-9">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9747643884-10">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p">,</span><span class="w"> </span><span class="ss">quicer</span><span class="p" data-group-id="9747643884-10">]</span><span class="p" data-group-id="9747643884-9">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9747643884-11">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9747643884-12">{</span><span class="ss">macula_quic_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9747643884-13">[</span><span class="p" data-group-id="9747643884-13">]</span><span class="p" data-group-id="9747643884-12">}</span><span class="p" data-group-id="9747643884-11">}</span><span class="w">
</span><span class="p" data-group-id="9747643884-2">]</span><span class="p" data-group-id="9747643884-1">}</span><span class="p">.</span><span class="w">

</span><span class="p" data-group-id="9747643884-14">{</span><span class="ss">deps</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9747643884-15">[</span><span class="w">
    </span><span class="p" data-group-id="9747643884-16">{</span><span class="ss">quicer</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9747643884-17">{</span><span class="ss">git</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;https://github.com/emqx/quic.git&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9747643884-18">{</span><span class="ss">branch</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;main&quot;</span><span class="p" data-group-id="9747643884-18">}</span><span class="p" data-group-id="9747643884-17">}</span><span class="p" data-group-id="9747643884-16">}</span><span class="w">
</span><span class="p" data-group-id="9747643884-15">]</span><span class="p" data-group-id="9747643884-14">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="3-macula_protocol" class="section-heading"><a href="#3-macula_protocol" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">3. <code class="inline">macula_protocol</code></span></h3><p><strong>Purpose</strong>: Wire protocol (message framing, encoding/decoding).</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_protocol</span><span class="p">.</span><span class="ss">erl</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="ss">protocol</span><span class="w"> </span><span class="n">API</span><span class="w">
</span><span class="ss">macula_frame</span><span class="p">.</span><span class="ss">erl</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="ss">encoding</span><span class="o">/</span><span class="ss">decoding</span><span class="w">
</span><span class="ss">macula_message</span><span class="p">.</span><span class="ss">erl</span><span class="w">         </span><span class="o">-</span><span class="w"> </span><span class="n">Message</span><span class="w"> </span><span class="ss">types</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">validation</span><span class="w">
</span><span class="ss">macula_codec</span><span class="p">.</span><span class="ss">erl</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">Binary</span><span class="w"> </span><span class="nf">serialization</span><span class="w"> </span><span class="p" data-group-id="6120795924-1">(</span><span class="n">Erlang</span><span class="w"> </span><span class="ss">term</span><span class="w"> </span><span class="ss">format</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">MessagePack</span><span class="p" data-group-id="6120795924-1">)</span></code></pre><p><strong>Message Types</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-1">(</span><span class="n">MSG_HANDSHAKE</span><span class="p">,</span><span class="w"> </span><span class="mi">16#01</span><span class="p" data-group-id="6386153696-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-2">(</span><span class="n">MSG_HANDSHAKE_ACK</span><span class="p">,</span><span class="w"> </span><span class="mi">16#02</span><span class="p" data-group-id="6386153696-2">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-3">(</span><span class="n">MSG_HEARTBEAT</span><span class="p">,</span><span class="w"> </span><span class="mi">16#03</span><span class="p" data-group-id="6386153696-3">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-4">(</span><span class="n">MSG_PING</span><span class="p">,</span><span class="w"> </span><span class="mi">16#04</span><span class="p" data-group-id="6386153696-4">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-5">(</span><span class="n">MSG_PONG</span><span class="p">,</span><span class="w"> </span><span class="mi">16#05</span><span class="p" data-group-id="6386153696-5">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-6">(</span><span class="n">MSG_PUBLISH</span><span class="p">,</span><span class="w"> </span><span class="mi">16#10</span><span class="p" data-group-id="6386153696-6">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-7">(</span><span class="n">MSG_SUBSCRIBE</span><span class="p">,</span><span class="w"> </span><span class="mi">16#11</span><span class="p" data-group-id="6386153696-7">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-8">(</span><span class="n">MSG_UNSUBSCRIBE</span><span class="p">,</span><span class="w"> </span><span class="mi">16#12</span><span class="p" data-group-id="6386153696-8">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-9">(</span><span class="n">MSG_EVENT</span><span class="p">,</span><span class="w"> </span><span class="mi">16#13</span><span class="p" data-group-id="6386153696-9">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-10">(</span><span class="n">MSG_RPC_CALL</span><span class="p">,</span><span class="w"> </span><span class="mi">16#20</span><span class="p" data-group-id="6386153696-10">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-11">(</span><span class="n">MSG_RPC_RESULT</span><span class="p">,</span><span class="w"> </span><span class="mi">16#21</span><span class="p" data-group-id="6386153696-11">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-12">(</span><span class="n">MSG_RPC_ERROR</span><span class="p">,</span><span class="w"> </span><span class="mi">16#22</span><span class="p" data-group-id="6386153696-12">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-13">(</span><span class="n">MSG_ERROR</span><span class="p">,</span><span class="w"> </span><span class="mi">16#F0</span><span class="p" data-group-id="6386153696-13">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="6386153696-14">(</span><span class="n">MSG_CLOSE</span><span class="p">,</span><span class="w"> </span><span class="mi">16#FF</span><span class="p" data-group-id="6386153696-14">)</span><span class="p">.</span></code></pre><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">macula_core</code></li></ul><p><strong>Optional Dependencies</strong>:</p><ul><li><code class="inline">msgpack</code> (if using MessagePack instead of Erlang term format)</li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="4206916350-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_protocol</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4206916350-2">[</span><span class="w">
    </span><span class="p" data-group-id="4206916350-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula wire protocol&quot;</span><span class="p" data-group-id="4206916350-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4206916350-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="4206916350-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4206916350-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4206916350-6">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p" data-group-id="4206916350-6">]</span><span class="p" data-group-id="4206916350-5">}</span><span class="w">
</span><span class="p" data-group-id="4206916350-2">]</span><span class="p" data-group-id="4206916350-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="4-macula_membership" class="section-heading"><a href="#4-macula_membership" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">4. <code class="inline">macula_membership</code></span></h3><p><strong>Purpose</strong>: SWIM-based membership and failure detection.</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_membership</span><span class="p">.</span><span class="ss">erl</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="ss">membership</span><span class="w"> </span><span class="n">API</span><span class="w">
</span><span class="ss">macula_swim</span><span class="p">.</span><span class="ss">erl</span><span class="w">            </span><span class="o">-</span><span class="w"> </span><span class="n">SWIM</span><span class="w"> </span><span class="ss">protocol</span><span class="w"> </span><span class="n">GenServer</span><span class="w">
</span><span class="ss">macula_swim_detector</span><span class="p">.</span><span class="ss">erl</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="ss">detector</span><span class="w">
</span><span class="ss">macula_swim_gossip</span><span class="p">.</span><span class="ss">erl</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Gossip</span><span class="w"> </span><span class="ss">dissemination</span><span class="w">
</span><span class="ss">macula_member</span><span class="p">.</span><span class="ss">erl</span><span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="n">Member</span><span class="w"> </span><span class="ss">record</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">state</span></code></pre><p><strong>Features</strong>:</p><ul><li>Membership list management</li><li>Direct ping / indirect ping</li><li>Suspicion mechanism</li><li>Incarnation numbers</li><li>Realm-scoped membership</li></ul><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">macula_core</code></li><li><code class="inline">macula_protocol</code></li><li><code class="inline">macula_quic</code></li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="3323991551-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_membership</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3323991551-2">[</span><span class="w">
    </span><span class="p" data-group-id="3323991551-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula SWIM membership&quot;</span><span class="p" data-group-id="3323991551-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3323991551-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="3323991551-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3323991551-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3323991551-6">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_protocol</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_quic</span><span class="p" data-group-id="3323991551-6">]</span><span class="p" data-group-id="3323991551-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3323991551-7">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3323991551-8">{</span><span class="ss">macula_membership_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3323991551-9">[</span><span class="p" data-group-id="3323991551-9">]</span><span class="p" data-group-id="3323991551-8">}</span><span class="p" data-group-id="3323991551-7">}</span><span class="w">
</span><span class="p" data-group-id="3323991551-2">]</span><span class="p" data-group-id="3323991551-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="5-macula_routing" class="section-heading"><a href="#5-macula_routing" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">5. <code class="inline">macula_routing</code></span></h3><p><strong>Purpose</strong>: Kademlia DHT for routing.</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_routing</span><span class="p">.</span><span class="ss">erl</span><span class="w">         </span><span class="o">-</span><span class="w"> </span><span class="n">Routing</span><span class="w"> </span><span class="n">API</span><span class="w">
</span><span class="ss">macula_kademlia</span><span class="p">.</span><span class="ss">erl</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">Kademlia</span><span class="w"> </span><span class="n">DHT</span><span class="w"> </span><span class="n">GenServer</span><span class="w">
</span><span class="ss">macula_k_bucket</span><span class="p">.</span><span class="ss">erl</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">K</span><span class="o">-</span><span class="ss">bucket</span><span class="w"> </span><span class="ss">management</span><span class="w">
</span><span class="ss">macula_node_lookup</span><span class="p">.</span><span class="ss">erl</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="nf">lookup</span><span class="w"> </span><span class="p" data-group-id="9153208743-1">(</span><span class="ss">iterative</span><span class="p" data-group-id="9153208743-1">)</span><span class="w">
</span><span class="ss">macula_topic_registry</span><span class="p">.</span><span class="ss">erl</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Topic</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Nodes</span><span class="w"> </span><span class="nf">mapping</span><span class="w"> </span><span class="p" data-group-id="9153208743-2">(</span><span class="ss">for</span><span class="w"> </span><span class="ss">pub</span><span class="o">/</span><span class="ss">sub</span><span class="p" data-group-id="9153208743-2">)</span><span class="w">
</span><span class="ss">macula_rpc_registry</span><span class="p">.</span><span class="ss">erl</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">RPC</span><span class="w"> </span><span class="ss">name</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="ss">mapping</span></code></pre><p><strong>Features</strong>:</p><ul><li>256 k-buckets (for 256-bit node IDs)</li><li>XOR distance metric</li><li>Iterative lookups</li><li>Bucket refresh</li><li>Realm partitioning</li></ul><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">macula_core</code></li><li><code class="inline">macula_membership</code></li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="3026229618-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_routing</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3026229618-2">[</span><span class="w">
    </span><span class="p" data-group-id="3026229618-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula Kademlia DHT routing&quot;</span><span class="p" data-group-id="3026229618-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3026229618-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="3026229618-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3026229618-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3026229618-6">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_membership</span><span class="p" data-group-id="3026229618-6">]</span><span class="p" data-group-id="3026229618-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3026229618-7">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3026229618-8">{</span><span class="ss">macula_routing_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3026229618-9">[</span><span class="p" data-group-id="3026229618-9">]</span><span class="p" data-group-id="3026229618-8">}</span><span class="p" data-group-id="3026229618-7">}</span><span class="w">
</span><span class="p" data-group-id="3026229618-2">]</span><span class="p" data-group-id="3026229618-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="6-macula_topology" class="section-heading"><a href="#6-macula_topology" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">6. <code class="inline">macula_topology</code></span></h3><p><strong>Purpose</strong>: Mesh topology management (k-regular graph).</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_topology</span><span class="p">.</span><span class="ss">erl</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">Topology</span><span class="w"> </span><span class="ss">management</span><span class="w">
</span><span class="ss">macula_k_regular</span><span class="p">.</span><span class="ss">erl</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="ss">k</span><span class="o">-</span><span class="ss">regular</span><span class="w"> </span><span class="ss">graph</span><span class="w"> </span><span class="ss">algorithm</span><span class="w">
</span><span class="ss">macula_connection_pool</span><span class="p">.</span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="ss">pool</span><span class="w"> </span><span class="ss">supervisor</span><span class="w">
</span><span class="ss">macula_connection</span><span class="p">.</span><span class="ss">erl</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">GenServer</span><span class="w"> </span><span class="ss">per</span><span class="w"> </span><span class="ss">peer</span><span class="w"> </span><span class="ss">connection</span></code></pre><p><strong>Features</strong>:</p><ul><li>k-regular graph topology</li><li>Connection lifecycle (connect, disconnect, reconnect)</li><li>Exponential backoff for reconnections</li><li>Topology visualization</li></ul><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">macula_core</code></li><li><code class="inline">macula_quic</code></li><li><code class="inline">macula_membership</code></li><li><code class="inline">macula_routing</code></li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="8969324572-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_topology</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8969324572-2">[</span><span class="w">
    </span><span class="p" data-group-id="8969324572-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula mesh topology management&quot;</span><span class="p" data-group-id="8969324572-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="8969324572-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="8969324572-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="8969324572-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8969324572-6">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_quic</span><span class="p">,</span><span class="w">
                    </span><span class="ss">macula_membership</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_routing</span><span class="p" data-group-id="8969324572-6">]</span><span class="p" data-group-id="8969324572-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="8969324572-7">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8969324572-8">{</span><span class="ss">macula_topology_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8969324572-9">[</span><span class="p" data-group-id="8969324572-9">]</span><span class="p" data-group-id="8969324572-8">}</span><span class="p" data-group-id="8969324572-7">}</span><span class="w">
</span><span class="p" data-group-id="8969324572-2">]</span><span class="p" data-group-id="8969324572-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="7-macula_pubsub" class="section-heading"><a href="#7-macula_pubsub" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">7. <code class="inline">macula_pubsub</code></span></h3><p><strong>Purpose</strong>: Publish/subscribe messaging.</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_pubsub</span><span class="p">.</span><span class="ss">erl</span><span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="n">Pub</span><span class="o">/</span><span class="ss">sub</span><span class="w"> </span><span class="n">API</span><span class="w">
</span><span class="ss">macula_topic_tree</span><span class="p">.</span><span class="ss">erl</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">Topic</span><span class="w"> </span><span class="ss">subscription</span><span class="w"> </span><span class="nf">tree</span><span class="w"> </span><span class="p" data-group-id="5898709878-1">(</span><span class="ss">pattern</span><span class="w"> </span><span class="ss">matching</span><span class="p" data-group-id="5898709878-1">)</span><span class="w">
</span><span class="ss">macula_subscription</span><span class="p">.</span><span class="ss">erl</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Subscription</span><span class="w"> </span><span class="ss">management</span><span class="w">
</span><span class="ss">macula_publisher</span><span class="p">.</span><span class="ss">erl</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="n">Publishing</span><span class="w"> </span><span class="ss">logic</span><span class="w">
</span><span class="ss">macula_event_router</span><span class="p">.</span><span class="ss">erl</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Event</span><span class="w"> </span><span class="ss">routing</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">subscribers</span></code></pre><p><strong>Features</strong>:</p><ul><li>Topic pattern matching (exact, prefix, wildcard)</li><li>Local and remote subscriptions</li><li>Subscription announcements (via DHT)</li><li>Event delivery guarantees (at-most-once, at-least-once)</li></ul><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">macula_core</code></li><li><code class="inline">macula_protocol</code></li><li><code class="inline">macula_routing</code></li><li><code class="inline">macula_topology</code></li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="7065014386-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_pubsub</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7065014386-2">[</span><span class="w">
    </span><span class="p" data-group-id="7065014386-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula pub/sub messaging&quot;</span><span class="p" data-group-id="7065014386-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7065014386-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="7065014386-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7065014386-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7065014386-6">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_protocol</span><span class="p">,</span><span class="w">
                    </span><span class="ss">macula_routing</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_topology</span><span class="p" data-group-id="7065014386-6">]</span><span class="p" data-group-id="7065014386-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7065014386-7">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7065014386-8">{</span><span class="ss">macula_pubsub_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7065014386-9">[</span><span class="p" data-group-id="7065014386-9">]</span><span class="p" data-group-id="7065014386-8">}</span><span class="p" data-group-id="7065014386-7">}</span><span class="w">
</span><span class="p" data-group-id="7065014386-2">]</span><span class="p" data-group-id="7065014386-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="8-macula_rpc" class="section-heading"><a href="#8-macula_rpc" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">8. <code class="inline">macula_rpc</code></span></h3><p><strong>Purpose</strong>: Remote procedure call (RPC) implementation.</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_rpc</span><span class="p">.</span><span class="ss">erl</span><span class="w">             </span><span class="o">-</span><span class="w"> </span><span class="n">RPC</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="p" data-group-id="4826970535-1">(</span><span class="ss">call</span><span class="p">,</span><span class="w"> </span><span class="nb">register</span><span class="p">,</span><span class="w"> </span><span class="nb">unregister</span><span class="p" data-group-id="4826970535-1">)</span><span class="w">
</span><span class="ss">macula_rpc_server</span><span class="p">.</span><span class="ss">erl</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">RPC</span><span class="w"> </span><span class="ss">request</span><span class="w"> </span><span class="ss">handler</span><span class="w">
</span><span class="ss">macula_rpc_client</span><span class="p">.</span><span class="ss">erl</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">RPC</span><span class="w"> </span><span class="ss">call</span><span class="w"> </span><span class="ss">client</span><span class="w">
</span><span class="ss">macula_rpc_registry</span><span class="p">.</span><span class="ss">erl</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="n">RPC</span><span class="w"> </span><span class="ss">endpoint</span><span class="w"> </span><span class="ss">registry</span></code></pre><p><strong>Features</strong>:</p><ul><li>Synchronous RPC (with timeout)</li><li>Asynchronous RPC (cast)</li><li>RPC endpoint registration (name → handler function)</li><li>Endpoint discovery via DHT</li><li>Load balancing (if multiple nodes register same RPC)</li></ul><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">macula_core</code></li><li><code class="inline">macula_protocol</code></li><li><code class="inline">macula_routing</code></li><li><code class="inline">macula_topology</code></li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0766364775-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_rpc</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0766364775-2">[</span><span class="w">
    </span><span class="p" data-group-id="0766364775-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula RPC&quot;</span><span class="p" data-group-id="0766364775-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0766364775-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="0766364775-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0766364775-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0766364775-6">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_protocol</span><span class="p">,</span><span class="w">
                    </span><span class="ss">macula_routing</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_topology</span><span class="p" data-group-id="0766364775-6">]</span><span class="p" data-group-id="0766364775-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0766364775-7">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0766364775-8">{</span><span class="ss">macula_rpc_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0766364775-9">[</span><span class="p" data-group-id="0766364775-9">]</span><span class="p" data-group-id="0766364775-8">}</span><span class="p" data-group-id="0766364775-7">}</span><span class="w">
</span><span class="p" data-group-id="0766364775-2">]</span><span class="p" data-group-id="0766364775-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="9-macula_discovery" class="section-heading"><a href="#9-macula_discovery" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">9. <code class="inline">macula_discovery</code></span></h3><p><strong>Purpose</strong>: Node discovery (DNS-SD, mDNS, static, cloud).</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_discovery</span><span class="p">.</span><span class="ss">erl</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="n">Discovery</span><span class="w"> </span><span class="ss">coordinator</span><span class="w">
</span><span class="ss">macula_discovery_static</span><span class="p">.</span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Static</span><span class="w"> </span><span class="ss">bootstrap</span><span class="w"> </span><span class="nb">nodes</span><span class="w">
</span><span class="ss">macula_discovery_mdns</span><span class="p">.</span><span class="ss">erl</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nf">mDNS</span><span class="w"> </span><span class="p" data-group-id="0071267779-1">(</span><span class="n">Multicast</span><span class="w"> </span><span class="n">DNS</span><span class="p" data-group-id="0071267779-1">)</span><span class="w">
</span><span class="ss">macula_discovery_dns</span><span class="p">.</span><span class="ss">erl</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">DNS</span><span class="w"> </span><span class="n">SRV</span><span class="w"> </span><span class="ss">records</span><span class="w">
</span><span class="ss">macula_discovery_consul</span><span class="p">.</span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Consul</span><span class="w"> </span><span class="ss">service</span><span class="w"> </span><span class="ss">discovery</span><span class="w">
</span><span class="ss">macula_discovery_k8s</span><span class="p">.</span><span class="ss">erl</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Kubernetes</span><span class="w"> </span><span class="ss">endpoints</span></code></pre><p><strong>Features</strong>:</p><ul><li>Multiple discovery methods (configurable)</li><li>Continuous discovery (periodic re-discovery)</li><li>Bootstrap node list</li><li>Realm-aware discovery</li></ul><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">macula_core</code></li><li><code class="inline">mdns</code> (for mDNS support)</li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0693791119-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_discovery</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0693791119-2">[</span><span class="w">
    </span><span class="p" data-group-id="0693791119-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula node discovery&quot;</span><span class="p" data-group-id="0693791119-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0693791119-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="0693791119-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0693791119-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0693791119-6">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p" data-group-id="0693791119-6">]</span><span class="p" data-group-id="0693791119-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0693791119-7">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0693791119-8">{</span><span class="ss">macula_discovery_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0693791119-9">[</span><span class="p" data-group-id="0693791119-9">]</span><span class="p" data-group-id="0693791119-8">}</span><span class="p" data-group-id="0693791119-7">}</span><span class="w">
</span><span class="p" data-group-id="0693791119-2">]</span><span class="p" data-group-id="0693791119-1">}</span><span class="p">.</span><span class="w">

</span><span class="p" data-group-id="0693791119-10">{</span><span class="ss">deps</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0693791119-11">[</span><span class="w">
    </span><span class="p" data-group-id="0693791119-12">{</span><span class="ss">mdns</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0693791119-13">{</span><span class="ss">git</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;https://github.com/benoitc/erlang-mdns.git&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0693791119-14">{</span><span class="ss">branch</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;master&quot;</span><span class="p" data-group-id="0693791119-14">}</span><span class="p" data-group-id="0693791119-13">}</span><span class="p" data-group-id="0693791119-12">}</span><span class="w">
</span><span class="p" data-group-id="0693791119-11">]</span><span class="p" data-group-id="0693791119-10">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="10-macula_security" class="section-heading"><a href="#10-macula_security" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">10. <code class="inline">macula_security</code></span></h3><p><strong>Purpose</strong>: Security (TLS certificates, ACLs, audit logging).</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_security</span><span class="p">.</span><span class="ss">erl</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">Security</span><span class="w"> </span><span class="n">API</span><span class="w">
</span><span class="ss">macula_cert</span><span class="p">.</span><span class="ss">erl</span><span class="w">            </span><span class="o">-</span><span class="w"> </span><span class="n">Certificate</span><span class="w"> </span><span class="ss">generation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">validation</span><span class="w">
</span><span class="ss">macula_acl</span><span class="p">.</span><span class="ss">erl</span><span class="w">             </span><span class="o">-</span><span class="w"> </span><span class="n">Access</span><span class="w"> </span><span class="ss">control</span><span class="w"> </span><span class="ss">lists</span><span class="w">
</span><span class="ss">macula_audit</span><span class="p">.</span><span class="ss">erl</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">Audit</span><span class="w"> </span><span class="ss">logging</span><span class="w">
</span><span class="ss">macula_crypto</span><span class="p">.</span><span class="ss">erl</span><span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="n">Message</span><span class="w"> </span><span class="ss">signing</span><span class="o">/</span><span class="ss">verification</span></code></pre><p><strong>Features</strong>:</p><ul><li>Certificate generation (self-signed, CA-signed)</li><li>Certificate validation (realm extraction from SAN)</li><li>ACL enforcement (topic/RPC access control)</li><li>Audit log (security events)</li><li>Optional message signing</li></ul><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">macula_core</code></li><li><code class="inline">public_key</code> (Erlang stdlib)</li><li><code class="inline">ssl</code> (Erlang stdlib)</li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="7364830055-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_security</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7364830055-2">[</span><span class="w">
    </span><span class="p" data-group-id="7364830055-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula security&quot;</span><span class="p" data-group-id="7364830055-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7364830055-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="7364830055-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7364830055-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7364830055-6">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">public_key</span><span class="p">,</span><span class="w"> </span><span class="ss">ssl</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p" data-group-id="7364830055-6">]</span><span class="p" data-group-id="7364830055-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7364830055-7">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7364830055-8">{</span><span class="ss">macula_security_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7364830055-9">[</span><span class="p" data-group-id="7364830055-9">]</span><span class="p" data-group-id="7364830055-8">}</span><span class="p" data-group-id="7364830055-7">}</span><span class="w">
</span><span class="p" data-group-id="7364830055-2">]</span><span class="p" data-group-id="7364830055-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="11-macula_gateway" class="section-heading"><a href="#11-macula_gateway" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">11. <code class="inline">macula_gateway</code></span></h3><p><strong>Purpose</strong>: Cross-realm gateway functionality.</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula_gateway</span><span class="p">.</span><span class="ss">erl</span><span class="w">         </span><span class="o">-</span><span class="w"> </span><span class="n">Gateway</span><span class="w"> </span><span class="n">API</span><span class="w">
</span><span class="ss">macula_gateway_server</span><span class="p">.</span><span class="ss">erl</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Gateway</span><span class="w"> </span><span class="n">GenServer</span><span class="w">
</span><span class="ss">macula_policy</span><span class="p">.</span><span class="ss">erl</span><span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="n">Policy</span><span class="w"> </span><span class="nf">engine</span><span class="w"> </span><span class="p" data-group-id="3133877148-1">(</span><span class="ss">topic</span><span class="w"> </span><span class="ss">filtering</span><span class="p">,</span><span class="w"> </span><span class="ss">rate</span><span class="w"> </span><span class="ss">limiting</span><span class="p" data-group-id="3133877148-1">)</span><span class="w">
</span><span class="ss">macula_translation</span><span class="p">.</span><span class="ss">erl</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Topic</span><span class="w"> </span><span class="ss">translation</span><span class="w">
</span><span class="ss">macula_rate_limiter</span><span class="p">.</span><span class="ss">erl</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Rate</span><span class="w"> </span><span class="ss">limiting</span><span class="w"> </span><span class="ss">per</span><span class="w"> </span><span class="ss">realm</span><span class="w"> </span><span class="ss">pair</span></code></pre><p><strong>Features</strong>:</p><ul><li>Multi-realm support</li><li>Policy-based message filtering</li><li>Topic translation</li><li>Rate limiting</li><li>Audit logging of cross-realm traffic</li></ul><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">macula_core</code></li><li><code class="inline">macula_protocol</code></li><li><code class="inline">macula_pubsub</code></li><li><code class="inline">macula_rpc</code></li><li><code class="inline">macula_security</code></li></ul><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0977696490-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_gateway</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0977696490-2">[</span><span class="w">
    </span><span class="p" data-group-id="0977696490-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula cross-realm gateway&quot;</span><span class="p" data-group-id="0977696490-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0977696490-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="0977696490-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0977696490-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0977696490-6">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_core</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_protocol</span><span class="p">,</span><span class="w">
                    </span><span class="ss">macula_pubsub</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_rpc</span><span class="p">,</span><span class="w"> </span><span class="ss">macula_security</span><span class="p" data-group-id="0977696490-6">]</span><span class="p" data-group-id="0977696490-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0977696490-7">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0977696490-8">{</span><span class="ss">macula_gateway_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0977696490-9">[</span><span class="p" data-group-id="0977696490-9">]</span><span class="p" data-group-id="0977696490-8">}</span><span class="p" data-group-id="0977696490-7">}</span><span class="w">
</span><span class="p" data-group-id="0977696490-2">]</span><span class="p" data-group-id="0977696490-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h3 id="12-macula-main-application" class="section-heading"><a href="#12-macula-main-application" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">12. <code class="inline">macula</code> (Main Application)</span></h3><p><strong>Purpose</strong>: Umbrella application that ties everything together.</p><p><strong>Modules</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="ss">macula</span><span class="p">.</span><span class="ss">erl</span><span class="w">                 </span><span class="o">-</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="n">API</span><span class="w">
</span><span class="ss">macula_app</span><span class="p">.</span><span class="ss">erl</span><span class="w">             </span><span class="o">-</span><span class="w"> </span><span class="n">Application</span><span class="w"> </span><span class="ss">callback</span><span class="w">
</span><span class="ss">macula_sup</span><span class="p">.</span><span class="ss">erl</span><span class="w">             </span><span class="o">-</span><span class="w"> </span><span class="n">Top</span><span class="o">-</span><span class="ss">level</span><span class="w"> </span><span class="ss">supervisor</span><span class="w">
</span><span class="ss">macula_config</span><span class="p">.</span><span class="ss">erl</span><span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="n">Configuration</span><span class="w"> </span><span class="ss">management</span></code></pre><p><strong>Supervision Tree</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="nf">macula_sup</span><span class="w"> </span><span class="p" data-group-id="2229525310-1">(</span><span class="ss">one_for_one</span><span class="p" data-group-id="2229525310-1">)</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_discovery_sup</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_quic_sup</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_membership_sup</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_routing_sup</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_topology_sup</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_pubsub_sup</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_rpc_sup</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">macula_security_sup</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="nf">macula_gateway_sup</span><span class="w"> </span><span class="p" data-group-id="2229525310-2">(</span><span class="ss">optional</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">gateway</span><span class="w"> </span><span class="ss">mode</span><span class="p" data-group-id="2229525310-2">)</span></code></pre><p><strong>Dependencies</strong>: All macula_* libraries</p><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="1386390336-1">{</span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">macula</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-2">[</span><span class="w">
    </span><span class="p" data-group-id="1386390336-3">{</span><span class="ss">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Macula HTTP/3 Mesh Platform&quot;</span><span class="p" data-group-id="1386390336-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1386390336-4">{</span><span class="ss">vsn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="1386390336-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1386390336-5">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-6">[</span><span class="w">
        </span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_core</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_quic</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_protocol</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_membership</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_routing</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_topology</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_pubsub</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_rpc</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_discovery</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_security</span><span class="p">,</span><span class="w">
        </span><span class="ss">macula_gateway</span><span class="w">
    </span><span class="p" data-group-id="1386390336-6">]</span><span class="p" data-group-id="1386390336-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1386390336-7">{</span><span class="ss">mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-8">{</span><span class="ss">macula_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-9">[</span><span class="p" data-group-id="1386390336-9">]</span><span class="p" data-group-id="1386390336-8">}</span><span class="p" data-group-id="1386390336-7">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1386390336-10">{</span><span class="ss">env</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-11">[</span><span class="w">
        </span><span class="p" data-group-id="1386390336-12">{</span><span class="ss">realm</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-13">&lt;&lt;</span><span class="s">&quot;org.example.mesh&quot;</span><span class="p" data-group-id="1386390336-13">&gt;&gt;</span><span class="p" data-group-id="1386390336-12">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="1386390336-14">{</span><span class="ss">listen_port</span><span class="p">,</span><span class="w"> </span><span class="mi">4433</span><span class="p" data-group-id="1386390336-14">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="1386390336-15">{</span><span class="ss">discovery</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-16">[</span><span class="p" data-group-id="1386390336-17">{</span><span class="ss">methods</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-18">[</span><span class="ss">static</span><span class="p">,</span><span class="w"> </span><span class="ss">mdns</span><span class="p" data-group-id="1386390336-18">]</span><span class="p" data-group-id="1386390336-17">}</span><span class="p" data-group-id="1386390336-16">]</span><span class="p" data-group-id="1386390336-15">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="1386390336-19">{</span><span class="ss">topology</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-20">[</span><span class="p" data-group-id="1386390336-21">{</span><span class="ss">type</span><span class="p">,</span><span class="w"> </span><span class="ss">k_regular</span><span class="p" data-group-id="1386390336-21">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1386390336-22">{</span><span class="ss">k</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="1386390336-22">}</span><span class="p" data-group-id="1386390336-20">]</span><span class="p" data-group-id="1386390336-19">}</span><span class="w">
    </span><span class="p" data-group-id="1386390336-11">]</span><span class="p" data-group-id="1386390336-10">}</span><span class="w">
</span><span class="p" data-group-id="1386390336-2">]</span><span class="p" data-group-id="1386390336-1">}</span><span class="p">.</span></code></pre><hr class="thin"/><h2 id="supporting-tools-and-utilities" class="section-heading"><a href="#supporting-tools-and-utilities" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Supporting Tools and Utilities</span></h2><h3 id="13-macula_cli" class="section-heading"><a href="#13-macula_cli" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">13. <code class="inline">macula_cli</code></span></h3><p><strong>Purpose</strong>: Command-line tool for Macula operations.</p><p><strong>Features</strong>:</p><ul><li>Start/stop nodes</li><li>Join mesh</li><li>View topology</li><li>Send test messages</li><li>Query membership</li><li>Inspect routing table</li></ul><p><strong>Implementation</strong>: Escript</p><p><strong>Rebar3 Config</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="9893234226-1">{</span><span class="ss">escript_name</span><span class="p">,</span><span class="w"> </span><span class="ss">macula</span><span class="p" data-group-id="9893234226-1">}</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="9893234226-2">{</span><span class="ss">escript_emu_args</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%%! -escript main macula_cli\n&quot;</span><span class="p" data-group-id="9893234226-2">}</span><span class="p">.</span></code></pre><p><strong>Usage</strong>:</p><pre><code class="makeup bash" translate="no"><span class="">macula start --realm org.example.mesh --port 4433
</span><span class="">macula join 192.168.1.100:4433
</span><span class="">macula topology
</span><span class="">macula publish topic.name &#39;{&quot;data&quot;: &quot;hello&quot;}&#39;
</span><span class="">macula stats
</span></code></pre><hr class="thin"/><h3 id="14-macula_observer" class="section-heading"><a href="#14-macula_observer" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">14. <code class="inline">macula_observer</code></span></h3><p><strong>Purpose</strong>: Real-time mesh visualization and monitoring.</p><p><strong>Features</strong>:</p><ul><li>Visual mesh topology (graphviz-style)</li><li>Live message flow</li><li>Membership state</li><li>Connection status</li><li>Metrics dashboard</li></ul><p><strong>Implementation</strong>: Phoenix LiveView application (if using Elixir)</p><p><strong>Alternative</strong>: Standalone Erlang application with web UI (Cowboy + WebSocket)</p><hr class="thin"/><h3 id="15-macula_loadtest" class="section-heading"><a href="#15-macula_loadtest" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">15. <code class="inline">macula_loadtest</code></span></h3><p><strong>Purpose</strong>: Load testing and benchmarking tool.</p><p><strong>Features</strong>:</p><ul><li>Spawn N virtual nodes</li><li>Pub/sub throughput testing</li><li>RPC latency testing</li><li>Failure injection</li><li>Report generation</li></ul><p><strong>Implementation</strong>: Standalone Erlang application using Tsung or custom framework</p><hr class="thin"/><h2 id="optional-future-libraries" class="section-heading"><a href="#optional-future-libraries" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Optional/Future Libraries</span></h2><h3 id="16-macula_wamp_compat" class="section-heading"><a href="#16-macula_wamp_compat" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">16. <code class="inline">macula_wamp_compat</code></span></h3><p><strong>Purpose</strong>: WAMP compatibility layer (bridge WAMP clients to Macula).</p><p><strong>Modules</strong>:</p><ul><li>WAMP protocol adapter</li><li>WebSocket server</li><li>Message translation (WAMP ↔ Macula)</li></ul><p><strong>Use Case</strong>: Migrate from Bondy/WAMP to Macula gradually</p><hr class="thin"/><h3 id="17-macula_http_bridge" class="section-heading"><a href="#17-macula_http_bridge" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">17. <code class="inline">macula_http_bridge</code></span></h3><p><strong>Purpose</strong>: HTTP/REST gateway for Macula (publish via HTTP POST).</p><p><strong>Modules</strong>:</p><ul><li>Cowboy HTTP handler</li><li>REST API (publish, call, subscribe via SSE)</li></ul><p><strong>Use Case</strong>: Non-BEAM clients accessing Macula</p><hr class="thin"/><h3 id="18-macula_kafka_connector" class="section-heading"><a href="#18-macula_kafka_connector" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">18. <code class="inline">macula_kafka_connector</code></span></h3><p><strong>Purpose</strong>: Kafka bridge (publish Macula events to Kafka, consume Kafka events).</p><p><strong>Dependencies</strong>: <code class="inline">brod</code> (Kafka client)</p><hr class="thin"/><h3 id="19-macula_postgres_connector" class="section-heading"><a href="#19-macula_postgres_connector" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">19. <code class="inline">macula_postgres_connector</code></span></h3><p><strong>Purpose</strong>: PostgreSQL integration (CDC, event sourcing).</p><p><strong>Dependencies</strong>: <code class="inline">epgsql</code> or <code class="inline">postgrex</code></p><hr class="thin"/><h3 id="20-macula_metrics" class="section-heading"><a href="#20-macula_metrics" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">20. <code class="inline">macula_metrics</code></span></h3><p><strong>Purpose</strong>: Metrics and observability (Prometheus, OpenTelemetry).</p><p><strong>Modules</strong>:</p><ul><li>Prometheus exporter</li><li>OpenTelemetry integration</li><li>StatsD reporter</li></ul><p><strong>Dependencies</strong>:</p><ul><li><code class="inline">prometheus</code> or <code class="inline">prometheus_ex</code></li><li><code class="inline">opentelemetry</code> and <code class="inline">opentelemetry_exporter</code></li></ul><hr class="thin"/><h2 id="development-roadmap" class="section-heading"><a href="#development-roadmap" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Development Roadmap</span></h2><h3 id="phase-1-foundation-weeks-1-4" class="section-heading"><a href="#phase-1-foundation-weeks-1-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Phase 1: Foundation (Weeks 1-4)</span></h3><p><strong>Goal</strong>: Get basic QUIC transport and protocol working.</p><p><strong>Libraries to build</strong>:</p><ol><li><code class="inline">macula_core</code> - Types and utilities</li><li><code class="inline">macula_quic</code> - QUIC wrapper</li><li><code class="inline">macula_protocol</code> - Wire protocol</li></ol><p><strong>Deliverable</strong>: Two nodes can connect and exchange handshake messages.</p><hr class="thin"/><h3 id="phase-2-mesh-topology-weeks-5-8" class="section-heading"><a href="#phase-2-mesh-topology-weeks-5-8" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Phase 2: Mesh Topology (Weeks 5-8)</span></h3><p><strong>Goal</strong>: Self-organizing mesh network.</p><p><strong>Libraries to build</strong>:</p><ol start="4"><li><code class="inline">macula_membership</code> - SWIM</li><li><code class="inline">macula_routing</code> - Kademlia DHT</li><li><code class="inline">macula_topology</code> - k-regular graph</li><li><code class="inline">macula_discovery</code> - Node discovery</li></ol><p><strong>Deliverable</strong>: N nodes form a mesh and detect failures.</p><hr class="thin"/><h3 id="phase-3-messaging-weeks-9-12" class="section-heading"><a href="#phase-3-messaging-weeks-9-12" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Phase 3: Messaging (Weeks 9-12)</span></h3><p><strong>Goal</strong>: Pub/sub and RPC working across mesh.</p><p><strong>Libraries to build</strong>:</p><ol start="8"><li><code class="inline">macula_pubsub</code> - Pub/sub</li><li><code class="inline">macula_rpc</code> - RPC</li></ol><p><strong>Deliverable</strong>: Applications can publish/subscribe and make RPC calls.</p><hr class="thin"/><h3 id="phase-4-security-and-gateways-weeks-13-16" class="section-heading"><a href="#phase-4-security-and-gateways-weeks-13-16" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Phase 4: Security and Gateways (Weeks 13-16)</span></h3><p><strong>Goal</strong>: Production-ready security and multi-tenancy.</p><p><strong>Libraries to build</strong>:</p><ol start="10"><li><code class="inline">macula_security</code> - Certificates, ACLs, audit</li><li><code class="inline">macula_gateway</code> - Cross-realm gateway</li></ol><p><strong>Deliverable</strong>: Secure mesh with realm isolation.</p><hr class="thin"/><h3 id="phase-5-tooling-and-monitoring-weeks-17-20" class="section-heading"><a href="#phase-5-tooling-and-monitoring-weeks-17-20" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Phase 5: Tooling and Monitoring (Weeks 17-20)</span></h3><p><strong>Goal</strong>: Developer experience and operations tooling.</p><p><strong>Tools to build</strong>:</p><ol start="13"><li><code class="inline">macula_cli</code> - Command-line tool</li><li><code class="inline">macula_observer</code> - Visualization</li><li><code class="inline">macula_loadtest</code> - Benchmarking</li><li><code class="inline">macula_metrics</code> - Observability</li></ol><p><strong>Deliverable</strong>: Production-ready platform with tooling.</p><hr class="thin"/><h2 id="testing-strategy" class="section-heading"><a href="#testing-strategy" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Testing Strategy</span></h2><h3 id="unit-tests" class="section-heading"><a href="#unit-tests" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Unit Tests</span></h3><p>Each library has its own test suite:</p><pre><code class="makeup erlang" translate="no"><span class="ss">apps</span><span class="o">/</span><span class="ss">macula_core</span><span class="o">/</span><span class="ss">test</span><span class="o">/</span><span class="w">
</span><span class="ss">apps</span><span class="o">/</span><span class="ss">macula_quic</span><span class="o">/</span><span class="ss">test</span><span class="o">/</span><span class="w">
</span><span class="ss">apps</span><span class="o">/</span><span class="ss">macula_protocol</span><span class="o">/</span><span class="ss">test</span><span class="o">/</span><span class="w">
</span><span class="p">.</span><span class="p">.</span><span class="p">.</span></code></pre><p><strong>Framework</strong>: EUnit (Erlang) or ExUnit (Elixir)</p><p><strong>Run</strong>:</p><pre><code class="makeup bash" translate="no"><span class="">rebar3 eunit
</span><span class=""># or
</span><span class="">mix test
</span></code></pre><hr class="thin"/><h3 id="integration-tests" class="section-heading"><a href="#integration-tests" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Integration Tests</span></h3><p>Multi-node integration tests:</p><pre><code class="makeup erlang" translate="no"><span class="ss">test</span><span class="o">/</span><span class="ss">integration</span><span class="o">/</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">mesh_formation_test</span><span class="p">.</span><span class="ss">erl</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">pubsub_test</span><span class="p">.</span><span class="ss">erl</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">rpc_test</span><span class="p">.</span><span class="ss">erl</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">failure_recovery_test</span><span class="p">.</span><span class="ss">erl</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">gateway_test</span><span class="p">.</span><span class="ss">erl</span></code></pre><p><strong>Framework</strong>: Common Test (Erlang)</p><p><strong>Run</strong>:</p><pre><code class="makeup bash" translate="no"><span class="">rebar3 ct
</span></code></pre><hr class="thin"/><h3 id="property-based-tests" class="section-heading"><a href="#property-based-tests" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Property-Based Tests</span></h3><p>Use PropEr (Erlang) or StreamData (Elixir):</p><pre><code class="makeup erlang" translate="no"><span class="ss">apps</span><span class="o">/</span><span class="ss">macula_routing</span><span class="o">/</span><span class="ss">test</span><span class="o">/</span><span class="ss">prop_kademlia</span><span class="p">.</span><span class="ss">erl</span><span class="w">
</span><span class="ss">apps</span><span class="o">/</span><span class="ss">macula_membership</span><span class="o">/</span><span class="ss">test</span><span class="o">/</span><span class="ss">prop_swim</span><span class="p">.</span><span class="ss">erl</span></code></pre><p><strong>Run</strong>:</p><pre><code class="makeup bash" translate="no"><span class="">rebar3 proper
</span></code></pre><hr class="thin"/><h3 id="load-tests" class="section-heading"><a href="#load-tests" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Load Tests</span></h3><p>Separate load testing suite:</p><pre><code class="makeup erlang" translate="no"><span class="ss">loadtest</span><span class="o">/</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">pubsub_throughput</span><span class="p">.</span><span class="ss">erl</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">rpc_latency</span><span class="p">.</span><span class="ss">erl</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">mesh_scale</span><span class="p">.</span><span class="nf">erl</span><span class="w"> </span><span class="p" data-group-id="6758870989-1">(</span><span class="mi">1000</span><span class="o">+</span><span class="w"> </span><span class="nb">nodes</span><span class="p" data-group-id="6758870989-1">)</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="ss">failure_injection</span><span class="p">.</span><span class="ss">erl</span></code></pre><p><strong>Framework</strong>: Tsung or custom</p><hr class="thin"/><h2 id="continuous-integration" class="section-heading"><a href="#continuous-integration" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Continuous Integration</span></h2><h3 id="github-actions-workflow" class="section-heading"><a href="#github-actions-workflow" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">GitHub Actions Workflow</span></h3><pre><code class="yaml">name: CI

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: erlef/setup-beam@v1
        with:
          otp-version: '26.2'
          rebar3-version: '3.22'
      - run: rebar3 compile
      - run: rebar3 eunit
      - run: rebar3 ct
      - run: rebar3 dialyzer

  integration:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: erlef/setup-beam@v1
      - run: rebar3 as test release
      - run: ./test/integration/run_all.sh</code></pre><hr class="thin"/><h2 id="release-strategy" class="section-heading"><a href="#release-strategy" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Release Strategy</span></h2><h3 id="rebar3-release" class="section-heading"><a href="#rebar3-release" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Rebar3 Release</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% rebar.config</span><span class="w">
</span><span class="p" data-group-id="3450513392-1">{</span><span class="ss">relx</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3450513392-2">[</span><span class="w">
    </span><span class="p" data-group-id="3450513392-3">{</span><span class="ss">release</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3450513392-4">{</span><span class="ss">macula</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span><span class="p" data-group-id="3450513392-4">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3450513392-5">[</span><span class="w">
        </span><span class="ss">macula</span><span class="p">,</span><span class="w">
        </span><span class="ss">sasl</span><span class="w">
    </span><span class="p" data-group-id="3450513392-5">]</span><span class="p" data-group-id="3450513392-3">}</span><span class="p">,</span><span class="w">

    </span><span class="p" data-group-id="3450513392-6">{</span><span class="ss">mode</span><span class="p">,</span><span class="w"> </span><span class="ss">prod</span><span class="p" data-group-id="3450513392-6">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3450513392-7">{</span><span class="ss">include_erts</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="3450513392-7">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3450513392-8">{</span><span class="ss">extended_start_script</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="3450513392-8">}</span><span class="p">,</span><span class="w">

    </span><span class="p" data-group-id="3450513392-9">{</span><span class="ss">overlay</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3450513392-10">[</span><span class="w">
        </span><span class="p" data-group-id="3450513392-11">{</span><span class="ss">copy</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;config/sys.config.example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;etc/sys.config&quot;</span><span class="p" data-group-id="3450513392-11">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="3450513392-12">{</span><span class="ss">copy</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;config/vm.args.example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;etc/vm.args&quot;</span><span class="p" data-group-id="3450513392-12">}</span><span class="w">
    </span><span class="p" data-group-id="3450513392-10">]</span><span class="p" data-group-id="3450513392-9">}</span><span class="w">
</span><span class="p" data-group-id="3450513392-2">]</span><span class="p" data-group-id="3450513392-1">}</span><span class="p">.</span></code></pre><p><strong>Build</strong>:</p><pre><code class="makeup bash" translate="no"><span class="">rebar3 release
</span></code></pre><p><strong>Result</strong>: <code class="inline">_build/default/rel/macula/</code></p><hr class="thin"/><h3 id="docker-image" class="section-heading"><a href="#docker-image" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Docker Image</span></h3><pre><code class="dockerfile">FROM erlang:26-alpine AS builder

WORKDIR /build
COPY . .
RUN rebar3 as prod release

FROM alpine:latest

RUN apk add --no-cache openssl ncurses-libs libstdc++

COPY --from=builder /build/_build/prod/rel/macula /opt/macula

EXPOSE 4433/udp

CMD [&quot;/opt/macula/bin/macula&quot;, &quot;foreground&quot;]</code></pre><p><strong>Build</strong>:</p><pre><code class="makeup bash" translate="no"><span class="">docker build -t macula:latest .
</span></code></pre><hr class="thin"/><h2 id="repository-initialization" class="section-heading"><a href="#repository-initialization" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Repository Initialization</span></h2><h3 id="create-umbrella-application" class="section-heading"><a href="#create-umbrella-application" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Create Umbrella Application</span></h3><pre><code class="makeup bash" translate="no"><span class=""># Erlang (Rebar3)
</span><span class="">rebar3 new umbrella macula
</span><span class="">cd macula
</span><span class="">
</span><span class=""># Create apps
</span><span class="">rebar3 new lib apps/macula_core
</span><span class="">rebar3 new lib apps/macula_quic
</span><span class="">rebar3 new lib apps/macula_protocol
</span><span class=""># ... etc
</span><span class="">
</span><span class=""># Compile
</span><span class="">rebar3 compile
</span><span class="">
</span><span class=""># Test
</span><span class="">rebar3 eunit
</span><span class="">
</span><span class=""># Release
</span><span class="">rebar3 release
</span></code></pre><h3 id="or-elixir-mix" class="section-heading"><a href="#or-elixir-mix" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">OR Elixir (Mix)</span></h3><pre><code class="makeup bash" translate="no"><span class=""># Elixir (Mix)
</span><span class="">mix new macula --umbrella
</span><span class="">cd macula
</span><span class="">
</span><span class=""># Create apps
</span><span class="">cd apps
</span><span class="">mix new macula_core
</span><span class="">mix new macula_quic
</span><span class="">mix new macula_protocol
</span><span class=""># ... etc
</span><span class="">
</span><span class="">cd ..
</span><span class="">
</span><span class=""># Compile
</span><span class="">mix compile
</span><span class="">
</span><span class=""># Test
</span><span class="">mix test
</span><span class="">
</span><span class=""># Release
</span><span class="">mix release
</span></code></pre><hr class="thin"/><h2 id="summary" class="section-heading"><a href="#summary" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Summary</span></h2><p><strong>Core Libraries</strong> (12):</p><ol><li>✅ <code class="inline">macula_core</code> - Core types and utilities</li><li>✅ <code class="inline">macula_quic</code> - QUIC transport</li><li>✅ <code class="inline">macula_protocol</code> - Wire protocol</li><li>✅ <code class="inline">macula_membership</code> - SWIM membership</li><li>✅ <code class="inline">macula_routing</code> - Kademlia DHT</li><li>✅ <code class="inline">macula_topology</code> - Mesh topology</li><li>✅ <code class="inline">macula_pubsub</code> - Pub/sub</li><li>✅ <code class="inline">macula_rpc</code> - RPC</li><li>✅ <code class="inline">macula_discovery</code> - Node discovery</li><li>✅ <code class="inline">macula_security</code> - Security</li><li>✅ <code class="inline">macula_gateway</code> - Cross-realm gateway</li><li>✅ <code class="inline">macula</code> - Main application</li></ol><p><strong>Tools</strong> (3):</p><ol start="13"><li>✅ <code class="inline">macula_cli</code> - CLI tool</li><li>✅ <code class="inline">macula_observer</code> - Visualization</li><li>✅ <code class="inline">macula_loadtest</code> - Load testing</li></ol><p><strong>Optional</strong> (5):</p><ol start="16"><li>⚠️ <code class="inline">macula_wamp_compat</code> - WAMP bridge</li><li>⚠️ <code class="inline">macula_http_bridge</code> - HTTP gateway</li><li>⚠️ <code class="inline">macula_kafka_connector</code> - Kafka integration</li><li>⚠️ <code class="inline">macula_postgres_connector</code> - PostgreSQL integration</li><li>⚠️ <code class="inline">macula_metrics</code> - Metrics/observability</li></ol><p><strong>Total</strong>: 20 libraries/applications</p><hr class="thin"/><p><strong>Next Step</strong>: Initialize the repository structure and start with Phase 1 (Foundation).</p><hr class="thin"/><p><strong>Last Updated</strong>: 2025-01-08
<strong>Maintainers</strong>: [To be assigned]</p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="v0-6-0_release_summary.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
v0.6.0 Release Summary
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="macula_http3_mesh_root.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Architecture
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/macula/0.7.7" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/macula/0.7.7">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/macula/0.7.7/show/architecture/MACULA_PROJECT_STRUCTURE.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="macula.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
