<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="macula v0.8.6">


    <title>Platform Vision — macula v0.8.6</title>

    <link rel="stylesheet" href="dist/html-erlang-DQDXQC7W.css" />

    <script defer src="dist/sidebar_items-BD101DD4.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="readme.html" class="sidebar-projectImage">
          <img src="assets/logo.svg" alt="macula" />
        </a>

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
macula
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.8.6
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of macula</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Macula Platform Vision</h1>


      <a href="https://github.com/macula-io/macula/blob/0.8.6/architecture/PLATFORM_VISION.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p><strong>Macula has evolved from a library to a distributed application platform.</strong></p><p>This document describes the architectural vision of Macula as a <strong>platform</strong> that hosts Line-of-Business, IoT, and TWEANN workloads in a decentralized mesh network.</p><hr class="thin"/><h2 id="platform-architecture-overview" class="section-heading"><a href="#platform-architecture-overview" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Platform Architecture Overview</span></h2><p align="center">  <img src="../artwork/macula-platform-vision.svg" alt="Macula Platform Architecture" width="100%"></p><hr class="thin"/><h2 id="platform-vs-library-the-evolution" class="section-heading"><a href="#platform-vs-library-the-evolution" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Platform vs Library: The Evolution</span></h2><h3 id="library-approach-legacy" class="section-heading"><a href="#library-approach-legacy" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Library Approach (Legacy)</span></h3><p>In the early days, Macula was conceived as a <strong>library</strong> that applications would import and use directly:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Application directly uses Macula internals</span><span class="w">
</span><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="6387997691-1">(</span><span class="ss">my_app</span><span class="p" data-group-id="6387997691-1">)</span><span class="p">.</span><span class="w">

</span><span class="nf">start</span><span class="p" data-group-id="6387997691-2">(</span><span class="p" data-group-id="6387997691-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% App manages connection lifecycle</span><span class="w">
    </span><span class="p" data-group-id="6387997691-3">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Conn</span><span class="p" data-group-id="6387997691-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula_connection</span><span class="p">:</span><span class="nf">start_link</span><span class="p" data-group-id="6387997691-4">(</span><span class="n">Url</span><span class="p">,</span><span class="w"> </span><span class="n">Opts</span><span class="p" data-group-id="6387997691-4">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% App deals with low-level primitives</span><span class="w">
    </span><span class="nc">macula_connection</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="6387997691-5">(</span><span class="n">Conn</span><span class="p">,</span><span class="w"> </span><span class="n">Topic</span><span class="p">,</span><span class="w"> </span><span class="n">Payload</span><span class="p" data-group-id="6387997691-5">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">macula_gateway</span><span class="p">:</span><span class="nf">route_message</span><span class="p" data-group-id="6387997691-6">(</span><span class="n">Msg</span><span class="p">,</span><span class="w"> </span><span class="n">Recipients</span><span class="p" data-group-id="6387997691-6">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">macula_routing_bucket</span><span class="p">:</span><span class="nf">find_closest_nodes</span><span class="p" data-group-id="6387997691-7">(</span><span class="n">NodeID</span><span class="p" data-group-id="6387997691-7">)</span><span class="p">.</span></code></pre><p><strong>Problems with the library approach:</strong></p><ul><li><strong>Tight coupling</strong> - Applications depend on Macula internals</li><li><strong>Duplication</strong> - Each app manages connections, handles failures</li><li><strong>Complexity</strong> - Business logic mixed with mesh infrastructure</li><li><strong>Versioning</strong> - Hard to upgrade Macula without breaking apps</li><li><strong>Testing</strong> - Apps need to mock mesh internals</li></ul><h3 id="platform-approach-current-vision" class="section-heading"><a href="#platform-approach-current-vision" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Platform Approach (Current Vision)</span></h3><p>Macula v0.8.5+ operates as a <strong>standalone OTP application</strong> that provides services to workloads:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Application uses clean SDK API</span><span class="w">
</span><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="7160422708-1">(</span><span class="ss">my_app</span><span class="p" data-group-id="7160422708-1">)</span><span class="p">.</span><span class="w">

</span><span class="nf">start</span><span class="p" data-group-id="7160422708-2">(</span><span class="p" data-group-id="7160422708-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Platform handles all mesh infrastructure</span><span class="w">
    </span><span class="c1">%% App just uses high-level operations</span><span class="w">

    </span><span class="c1">%% Publish events</span><span class="w">
    </span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="7160422708-3">(</span><span class="p" data-group-id="7160422708-4">&lt;&lt;</span><span class="s">&quot;orders.created&quot;</span><span class="p" data-group-id="7160422708-4">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">OrderData</span><span class="p" data-group-id="7160422708-3">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% Subscribe to topics</span><span class="w">
    </span><span class="nc">macula</span><span class="p">:</span><span class="nf">subscribe</span><span class="p" data-group-id="7160422708-5">(</span><span class="p" data-group-id="7160422708-6">&lt;&lt;</span><span class="s">&quot;inventory.*&quot;</span><span class="p" data-group-id="7160422708-6">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="ss">handle_inventory</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="7160422708-5">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% RPC to services</span><span class="w">
    </span><span class="p" data-group-id="7160422708-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Price</span><span class="p" data-group-id="7160422708-7">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="7160422708-8">(</span><span class="p" data-group-id="7160422708-9">&lt;&lt;</span><span class="s">&quot;pricing.calculate&quot;</span><span class="p" data-group-id="7160422708-9">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Request</span><span class="p" data-group-id="7160422708-8">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% Advertise services</span><span class="w">
    </span><span class="nc">macula</span><span class="p">:</span><span class="nf">advertise</span><span class="p" data-group-id="7160422708-10">(</span><span class="p" data-group-id="7160422708-11">&lt;&lt;</span><span class="s">&quot;orders.process&quot;</span><span class="p" data-group-id="7160422708-11">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="ss">process_order</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="7160422708-10">)</span><span class="p">.</span></code></pre><p><strong>Benefits of the platform approach:</strong></p><ul><li><strong>Clean separation</strong> - Business logic isolated from infrastructure</li><li><strong>Simple API</strong> - High-level operations, no internals exposed</li><li><strong>Independent deployment</strong> - Upgrade platform without touching apps</li><li><strong>Shared infrastructure</strong> - Multiple apps share one Macula instance</li><li><strong>Testability</strong> - Apps test business logic, not mesh behavior</li></ul><hr class="thin"/><h2 id="workload-types" class="section-heading"><a href="#workload-types" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Workload Types</span></h2><p>Macula supports three primary workload categories:</p><h3 id="1-line-of-business-lob-applications" class="section-heading"><a href="#1-line-of-business-lob-applications" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">1. Line-of-Business (LoB) Applications</span></h3><p>Traditional business applications that require distributed communication:</p><p><strong>Examples:</strong></p><ul><li>Order management systems</li><li>Inventory tracking</li><li>Customer relationship management</li><li>Financial transaction processing</li><li>Supply chain coordination</li></ul><p><strong>Characteristics:</strong></p><ul><li>Request/response patterns (RPC)</li><li>Event-driven workflows (pub/sub)</li><li>Multi-service orchestration</li><li>Data consistency requirements</li></ul><p><strong>Architecture Pattern:</strong></p><pre><code class="makeup erlang" translate="no"><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="n">Order</span><span class="w"> </span><span class="n">Service</span><span class="w">                 </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="n">Business</span><span class="w"> </span><span class="n">Logic</span><span class="w">         </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Validate</span><span class="w"> </span><span class="ss">order</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="ss">inventory</span><span class="w">      </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Process</span><span class="w"> </span><span class="ss">payment</span><span class="w">      </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┬</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">                </span><span class="err">│</span><span class="w"> </span><span class="n">SDK</span><span class="w">            </span><span class="err">│</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">
                 </span><span class="err">↓</span><span class="w">
         </span><span class="p" data-group-id="4049114810-1">[</span><span class="n">Macula</span><span class="w"> </span><span class="n">Platform</span><span class="p" data-group-id="4049114810-1">]</span><span class="w">
                 </span><span class="err">↓</span><span class="w">
    </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
    </span><span class="err">↓</span><span class="w">            </span><span class="err">↓</span><span class="w">            </span><span class="err">↓</span><span class="w">
</span><span class="p" data-group-id="4049114810-2">[</span><span class="n">Inventory</span><span class="p" data-group-id="4049114810-2">]</span><span class="w">  </span><span class="p" data-group-id="4049114810-3">[</span><span class="n">Payment</span><span class="p" data-group-id="4049114810-3">]</span><span class="w">  </span><span class="p" data-group-id="4049114810-4">[</span><span class="n">Shipping</span><span class="p" data-group-id="4049114810-4">]</span></code></pre><h3 id="2-iot-internet-of-things-workloads" class="section-heading"><a href="#2-iot-internet-of-things-workloads" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">2. IoT (Internet of Things) Workloads</span></h3><p>Edge computing and sensor network applications:</p><p><strong>Examples:</strong></p><ul><li>Smart home controllers</li><li>Industrial sensor networks</li><li>Agricultural monitoring</li><li>Fleet management</li><li>Environmental sensors</li></ul><p><strong>Characteristics:</strong></p><ul><li>High-frequency data streams</li><li>Low-latency requirements</li><li>Resource-constrained devices</li><li>Local-first processing</li><li>Eventual consistency</li></ul><p><strong>Architecture Pattern:</strong></p><pre><code class="makeup erlang" translate="no"><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="n">Smart</span><span class="w"> </span><span class="n">Home</span><span class="w"> </span><span class="n">Hub</span><span class="w">                </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="n">Device</span><span class="w"> </span><span class="n">Controller</span><span class="w">      </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Aggregate</span><span class="w"> </span><span class="ss">sensors</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="ss">actuators</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="ss">automation</span><span class="w">     </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┬</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">                </span><span class="err">│</span><span class="w"> </span><span class="n">SDK</span><span class="w">            </span><span class="err">│</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">
                 </span><span class="err">↓</span><span class="w">
         </span><span class="p" data-group-id="0499949963-1">[</span><span class="n">Macula</span><span class="w"> </span><span class="n">Platform</span><span class="p" data-group-id="0499949963-1">]</span><span class="w">
                 </span><span class="err">↓</span><span class="w">
    </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
    </span><span class="err">↓</span><span class="w">            </span><span class="err">↓</span><span class="w">            </span><span class="err">↓</span><span class="w">
</span><span class="p" data-group-id="0499949963-2">[</span><span class="n">Sensors</span><span class="p" data-group-id="0499949963-2">]</span><span class="w">   </span><span class="p" data-group-id="0499949963-3">[</span><span class="n">Actuators</span><span class="p" data-group-id="0499949963-3">]</span><span class="w">  </span><span class="p" data-group-id="0499949963-4">[</span><span class="n">Cloud</span><span class="p" data-group-id="0499949963-4">]</span></code></pre><h3 id="3-tweann-topology-weight-evolving-artificial-neural-networks" class="section-heading"><a href="#3-tweann-topology-weight-evolving-artificial-neural-networks" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">3. TWEANN (Topology &amp; Weight Evolving Artificial Neural Networks)</span></h3><p>Distributed evolutionary computation and neural network training:</p><p><strong>Examples:</strong></p><ul><li>NEAT (NeuroEvolution of Augmenting Topologies)</li><li>Genetic algorithm populations</li><li>Distributed machine learning</li><li>Hyperparameter optimization</li><li>Swarm intelligence</li></ul><p><strong>Characteristics:</strong></p><ul><li>Parallel evaluation</li><li>Population distribution</li><li>Fitness aggregation</li><li>Genome broadcasting</li><li>Generation synchronization</li></ul><p><strong>Architecture Pattern:</strong></p><pre><code class="makeup erlang" translate="no"><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="n">NEAT</span><span class="w"> </span><span class="n">Coordinator</span><span class="w">              </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="n">Evolution</span><span class="w"> </span><span class="n">Engine</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Select</span><span class="w"> </span><span class="ss">parents</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Crossover</span><span class="o">/</span><span class="ss">mutate</span><span class="w">     </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Aggregate</span><span class="w"> </span><span class="ss">fitness</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┬</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">                </span><span class="err">│</span><span class="w"> </span><span class="n">SDK</span><span class="w">            </span><span class="err">│</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">
                 </span><span class="err">↓</span><span class="w">
         </span><span class="p" data-group-id="9377342648-1">[</span><span class="n">Macula</span><span class="w"> </span><span class="n">Platform</span><span class="p" data-group-id="9377342648-1">]</span><span class="w">
                 </span><span class="err">↓</span><span class="w">
    </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
    </span><span class="err">↓</span><span class="w">            </span><span class="err">↓</span><span class="w">            </span><span class="err">↓</span><span class="w">
</span><span class="p" data-group-id="9377342648-2">[</span><span class="n">Evaluator</span><span class="p" data-group-id="9377342648-2">]</span><span class="w"> </span><span class="p" data-group-id="9377342648-3">[</span><span class="n">Evaluator</span><span class="p" data-group-id="9377342648-3">]</span><span class="w"> </span><span class="p" data-group-id="9377342648-4">[</span><span class="n">Evaluator</span><span class="p" data-group-id="9377342648-4">]</span><span class="w">
   </span><span class="n">Node</span><span class="w"> </span><span class="mi">1</span><span class="w">      </span><span class="n">Node</span><span class="w"> </span><span class="mi">2</span><span class="w">      </span><span class="n">Node</span><span class="w"> </span><span class="n">N</span></code></pre><hr class="thin"/><h2 id="platform-components" class="section-heading"><a href="#platform-components" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Platform Components</span></h2><h3 id="core-infrastructure-always-running" class="section-heading"><a href="#core-infrastructure-always-running" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Core Infrastructure (Always Running)</span></h3><p>These components start automatically when Macula boots:</p><table><thead><tr><th style="text-align: left;">Component</th><th style="text-align: left;">Purpose</th><th style="text-align: left;">Process Count</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">macula_routing_server</code></td><td style="text-align: left;">Kademlia DHT routing</td><td style="text-align: left;">1</td></tr><tr><td style="text-align: left;"><code class="inline">macula_bootstrap_system</code></td><td style="text-align: left;">Peer discovery, service registry</td><td style="text-align: left;">3</td></tr><tr><td style="text-align: left;"><code class="inline">macula_gateway_system</code></td><td style="text-align: left;">QUIC transport, message routing</td><td style="text-align: left;">9</td></tr><tr><td style="text-align: left;"><code class="inline">macula_peers_sup</code></td><td style="text-align: left;">Dynamic peer connections</td><td style="text-align: left;">1 + 4/peer</td></tr></tbody></table><p><strong>Total base processes:</strong> 17 (v0.8.5+)</p><h3 id="sdk-layer" class="section-heading"><a href="#sdk-layer" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">SDK Layer</span></h3><p>The SDK provides the public API for applications:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Core Operations</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="0353379730-1">(</span><span class="n">Topic</span><span class="p">,</span><span class="w"> </span><span class="n">Payload</span><span class="p" data-group-id="0353379730-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">ok</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="0353379730-2">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="0353379730-2">}</span><span class="p">.</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">subscribe</span><span class="p" data-group-id="0353379730-3">(</span><span class="n">Pattern</span><span class="p">,</span><span class="w"> </span><span class="n">Handler</span><span class="p" data-group-id="0353379730-3">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="0353379730-4">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">SubId</span><span class="p" data-group-id="0353379730-4">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="0353379730-5">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="0353379730-5">}</span><span class="p">.</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">unsubscribe</span><span class="p" data-group-id="0353379730-6">(</span><span class="n">SubId</span><span class="p" data-group-id="0353379730-6">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">ok</span><span class="p">.</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="0353379730-7">(</span><span class="n">Service</span><span class="p">,</span><span class="w"> </span><span class="n">Request</span><span class="p" data-group-id="0353379730-7">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="0353379730-8">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Response</span><span class="p" data-group-id="0353379730-8">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="0353379730-9">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="0353379730-9">}</span><span class="p">.</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="0353379730-10">(</span><span class="n">Service</span><span class="p">,</span><span class="w"> </span><span class="n">Request</span><span class="p">,</span><span class="w"> </span><span class="n">Timeout</span><span class="p" data-group-id="0353379730-10">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="0353379730-11">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Response</span><span class="p" data-group-id="0353379730-11">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="0353379730-12">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="0353379730-12">}</span><span class="p">.</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">advertise</span><span class="p" data-group-id="0353379730-13">(</span><span class="n">Service</span><span class="p">,</span><span class="w"> </span><span class="n">Handler</span><span class="p" data-group-id="0353379730-13">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="0353379730-14">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">AdvId</span><span class="p" data-group-id="0353379730-14">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="0353379730-15">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="0353379730-15">}</span><span class="p">.</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">unadvertise</span><span class="p" data-group-id="0353379730-16">(</span><span class="n">AdvId</span><span class="p" data-group-id="0353379730-16">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">ok</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Discovery</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">discover</span><span class="p" data-group-id="0353379730-17">(</span><span class="n">ServicePattern</span><span class="p" data-group-id="0353379730-17">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="0353379730-18">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0353379730-19">[</span><span class="n">Service</span><span class="p" data-group-id="0353379730-19">]</span><span class="p" data-group-id="0353379730-18">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="0353379730-20">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="0353379730-20">}</span><span class="p">.</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">node_id</span><span class="p" data-group-id="0353379730-21">(</span><span class="p" data-group-id="0353379730-21">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">NodeId</span><span class="p">.</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">peers</span><span class="p" data-group-id="0353379730-22">(</span><span class="p" data-group-id="0353379730-22">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="0353379730-23">[</span><span class="n">PeerId</span><span class="p" data-group-id="0353379730-23">]</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Health</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">health</span><span class="p" data-group-id="0353379730-24">(</span><span class="p" data-group-id="0353379730-24">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="0353379730-25">#{</span><span class="ss">status</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">ok</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">degraded</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="0353379730-25">}</span><span class="p">.</span></code></pre><h3 id="multi-tenancy-via-realms" class="section-heading"><a href="#multi-tenancy-via-realms" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Multi-Tenancy via Realms</span></h3><p>Realms provide isolation between different applications or environments:</p><pre><code class="makeup erlang" translate="no"><span class="n">Realm</span><span class="p">:</span><span class="w"> </span><span class="ss">com</span><span class="p">.</span><span class="ss">example</span><span class="p">.</span><span class="ss">production</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Order</span><span class="w"> </span><span class="n">Service</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Inventory</span><span class="w"> </span><span class="n">Service</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Payment</span><span class="w"> </span><span class="n">Service</span><span class="w">

</span><span class="n">Realm</span><span class="p">:</span><span class="w"> </span><span class="ss">com</span><span class="p">.</span><span class="ss">example</span><span class="p">.</span><span class="ss">staging</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Order</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="p" data-group-id="0504231616-1">(</span><span class="ss">test</span><span class="p" data-group-id="0504231616-1">)</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Inventory</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="p" data-group-id="0504231616-2">(</span><span class="ss">test</span><span class="p" data-group-id="0504231616-2">)</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Payment</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="p" data-group-id="0504231616-3">(</span><span class="ss">test</span><span class="p" data-group-id="0504231616-3">)</span><span class="w">

</span><span class="n">Realm</span><span class="p">:</span><span class="w"> </span><span class="ss">com</span><span class="p">.</span><span class="ss">acme</span><span class="p">.</span><span class="ss">iot</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Sensor</span><span class="w"> </span><span class="n">Network</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Hub</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Analytics</span></code></pre><p><strong>Isolation guarantees:</strong></p><ul><li>Messages don't cross realm boundaries</li><li>Services only visible within their realm</li><li>DHT routing scoped to realm</li><li>Connection pooling per realm</li></ul><hr class="thin"/><h2 id="deployment-models" class="section-heading"><a href="#deployment-models" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Deployment Models</span></h2><h3 id="model-1-embedded-development" class="section-heading"><a href="#model-1-embedded-development" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Model 1: Embedded (Development)</span></h3><p>Macula and application in the same BEAM VM:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% sys.config</span><span class="w">
</span><span class="p" data-group-id="3625977606-1">[</span><span class="w">
  </span><span class="p" data-group-id="3625977606-2">{</span><span class="ss">macula</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3625977606-3">[</span><span class="w">
    </span><span class="p" data-group-id="3625977606-4">{</span><span class="ss">quic_port</span><span class="p">,</span><span class="w"> </span><span class="mi">4433</span><span class="p" data-group-id="3625977606-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3625977606-5">{</span><span class="ss">realm</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3625977606-6">&lt;&lt;</span><span class="s">&quot;com.example.dev&quot;</span><span class="p" data-group-id="3625977606-6">&gt;&gt;</span><span class="p" data-group-id="3625977606-5">}</span><span class="w">
  </span><span class="p" data-group-id="3625977606-3">]</span><span class="p" data-group-id="3625977606-2">}</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="3625977606-7">{</span><span class="ss">my_app</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3625977606-8">[</span><span class="w">
    </span><span class="c1">%% app config</span><span class="w">
  </span><span class="p" data-group-id="3625977606-8">]</span><span class="p" data-group-id="3625977606-7">}</span><span class="w">
</span><span class="p" data-group-id="3625977606-1">]</span><span class="p">.</span></code></pre><p><strong>Use cases:</strong></p><ul><li>Local development</li><li>Testing</li><li>Single-node deployments</li></ul><h3 id="model-2-sidecar-production" class="section-heading"><a href="#model-2-sidecar-production" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Model 2: Sidecar (Production)</span></h3><p>Macula runs as a sidecar container:</p><pre><code class="yaml">apiVersion: v1
kind: Pod
metadata:
  name: order-service
spec:
  containers:
  - name: macula
    image: macula:0.8.5
    ports:
    - containerPort: 4433
      protocol: UDP
    env:
    - name: MACULA_QUIC_PORT
      value: &quot;4433&quot;
    - name: MACULA_REALM
      value: &quot;com.example.production&quot;
    volumeMounts:
    - name: certs
      mountPath: /var/lib/macula

  - name: order-service
    image: order-service:latest
    env:
    - name: MACULA_URL
      value: &quot;https://localhost:4433&quot;

  volumes:
  - name: certs
    persistentVolumeClaim:
      claimName: macula-certs</code></pre><p><strong>Use cases:</strong></p><ul><li>Kubernetes deployments</li><li>Microservices architectures</li><li>Language-agnostic applications</li></ul><h3 id="model-3-mesh-node-edge" class="section-heading"><a href="#model-3-mesh-node-edge" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Model 3: Mesh Node (Edge)</span></h3><p>Dedicated Macula nodes forming mesh backbone:</p><pre><code class="makeup erlang" translate="no"><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">     </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">     </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
</span><span class="err">│</span><span class="w">  </span><span class="n">Macula</span><span class="w">     </span><span class="err">│</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">▶</span><span class="err">│</span><span class="w">  </span><span class="n">Macula</span><span class="w">     </span><span class="err">│</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">▶</span><span class="err">│</span><span class="w">  </span><span class="n">Macula</span><span class="w">     </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">  </span><span class="n">Node</span><span class="w"> </span><span class="mi">1</span><span class="w">     </span><span class="err">│</span><span class="err">◀</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">│</span><span class="w">  </span><span class="n">Node</span><span class="w"> </span><span class="mi">2</span><span class="w">     </span><span class="err">│</span><span class="err">◀</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">│</span><span class="w">  </span><span class="n">Node</span><span class="w"> </span><span class="mi">3</span><span class="w">     </span><span class="err">│</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┬</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">     </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┬</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">     </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┬</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">
       </span><span class="err">│</span><span class="w">                   </span><span class="err">│</span><span class="w">                   </span><span class="err">│</span><span class="w">
       </span><span class="err">↓</span><span class="w">                   </span><span class="err">↓</span><span class="w">                   </span><span class="err">↓</span><span class="w">
   </span><span class="p" data-group-id="5346788012-1">[</span><span class="n">IoT</span><span class="w"> </span><span class="n">Devices</span><span class="p" data-group-id="5346788012-1">]</span><span class="w">      </span><span class="p" data-group-id="5346788012-2">[</span><span class="n">LoB</span><span class="w"> </span><span class="n">Apps</span><span class="p" data-group-id="5346788012-2">]</span><span class="w">         </span><span class="p" data-group-id="5346788012-3">[</span><span class="n">TWEANN</span><span class="w"> </span><span class="n">Workers</span><span class="p" data-group-id="5346788012-3">]</span></code></pre><p><strong>Use cases:</strong></p><ul><li>Edge computing</li><li>IoT gateways</li><li>Distributed AI training</li></ul><hr class="thin"/><h2 id="communication-patterns" class="section-heading"><a href="#communication-patterns" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Communication Patterns</span></h2><h3 id="pattern-1-event-driven-pub-sub" class="section-heading"><a href="#pattern-1-event-driven-pub-sub" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Pattern 1: Event-Driven (Pub/Sub)</span></h3><p>Asynchronous event broadcasting:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Publisher</span><span class="w">
</span><span class="nf">handle_order_created</span><span class="p" data-group-id="5491066614-1">(</span><span class="n">Order</span><span class="p" data-group-id="5491066614-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="5491066614-2">(</span><span class="p" data-group-id="5491066614-3">&lt;&lt;</span><span class="s">&quot;orders.created&quot;</span><span class="p" data-group-id="5491066614-3">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5491066614-4">#{</span><span class="w">
        </span><span class="ss">order_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Order</span><span class="o">#</span><span class="ss">order</span><span class="p">.</span><span class="ss">id</span><span class="p">,</span><span class="w">
        </span><span class="ss">customer</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Order</span><span class="o">#</span><span class="ss">order</span><span class="p">.</span><span class="ss">customer</span><span class="p">,</span><span class="w">
        </span><span class="ss">items</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Order</span><span class="o">#</span><span class="ss">order</span><span class="p">.</span><span class="ss">items</span><span class="p">,</span><span class="w">
        </span><span class="ss">total</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Order</span><span class="o">#</span><span class="ss">order</span><span class="p">.</span><span class="ss">total</span><span class="w">
    </span><span class="p" data-group-id="5491066614-4">}</span><span class="p" data-group-id="5491066614-2">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Subscriber</span><span class="w">
</span><span class="nf">init</span><span class="p" data-group-id="5491066614-5">(</span><span class="p" data-group-id="5491066614-6">[</span><span class="p" data-group-id="5491066614-6">]</span><span class="p" data-group-id="5491066614-5">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="5491066614-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="5491066614-7">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">subscribe</span><span class="p" data-group-id="5491066614-8">(</span><span class="p" data-group-id="5491066614-9">&lt;&lt;</span><span class="s">&quot;orders.*&quot;</span><span class="p" data-group-id="5491066614-9">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="ss">handle_order_event</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="5491066614-8">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="5491066614-10">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">state</span><span class="p" data-group-id="5491066614-11">{</span><span class="p" data-group-id="5491066614-11">}</span><span class="p" data-group-id="5491066614-10">}</span><span class="p">.</span><span class="w">

</span><span class="nf">handle_order_event</span><span class="p" data-group-id="5491066614-12">(</span><span class="p" data-group-id="5491066614-13">#{</span><span class="ss">topic</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="p" data-group-id="5491066614-14">&lt;&lt;</span><span class="s">&quot;orders.created&quot;</span><span class="p" data-group-id="5491066614-14">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="ss">payload</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="5491066614-13">}</span><span class="p" data-group-id="5491066614-12">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nf">update_inventory</span><span class="p" data-group-id="5491066614-15">(</span><span class="n">Order</span><span class="p" data-group-id="5491066614-15">)</span><span class="p">;</span><span class="w">
</span><span class="nf">handle_order_event</span><span class="p" data-group-id="5491066614-16">(</span><span class="p" data-group-id="5491066614-17">#{</span><span class="ss">topic</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="p" data-group-id="5491066614-18">&lt;&lt;</span><span class="s">&quot;orders.shipped&quot;</span><span class="p" data-group-id="5491066614-18">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="ss">payload</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Shipment</span><span class="p" data-group-id="5491066614-17">}</span><span class="p" data-group-id="5491066614-16">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nf">notify_customer</span><span class="p" data-group-id="5491066614-19">(</span><span class="n">Shipment</span><span class="p" data-group-id="5491066614-19">)</span><span class="p">.</span></code></pre><p><strong>Topic patterns:</strong></p><ul><li><code class="inline">orders.created</code> - Exact match</li><li><code class="inline">orders.*</code> - Single-level wildcard</li><li><code class="inline">orders.&gt;</code> - Multi-level wildcard (future)</li></ul><h3 id="pattern-2-request-response-rpc" class="section-heading"><a href="#pattern-2-request-response-rpc" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Pattern 2: Request/Response (RPC)</span></h3><p>Synchronous service calls:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Service provider</span><span class="w">
</span><span class="nf">init</span><span class="p" data-group-id="5167140400-1">(</span><span class="p" data-group-id="5167140400-2">[</span><span class="p" data-group-id="5167140400-2">]</span><span class="p" data-group-id="5167140400-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="5167140400-3">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="5167140400-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">advertise</span><span class="p" data-group-id="5167140400-4">(</span><span class="p" data-group-id="5167140400-5">&lt;&lt;</span><span class="s">&quot;pricing.calculate&quot;</span><span class="p" data-group-id="5167140400-5">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="ss">calculate_price</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="5167140400-4">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="5167140400-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">state</span><span class="p" data-group-id="5167140400-7">{</span><span class="p" data-group-id="5167140400-7">}</span><span class="p" data-group-id="5167140400-6">}</span><span class="p">.</span><span class="w">

</span><span class="nf">calculate_price</span><span class="p" data-group-id="5167140400-8">(</span><span class="p" data-group-id="5167140400-9">#{</span><span class="ss">items</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Items</span><span class="p">,</span><span class="w"> </span><span class="ss">customer</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Customer</span><span class="p" data-group-id="5167140400-9">}</span><span class="p" data-group-id="5167140400-8">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">BasePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum_items</span><span class="p" data-group-id="5167140400-10">(</span><span class="n">Items</span><span class="p" data-group-id="5167140400-10">)</span><span class="p">,</span><span class="w">
    </span><span class="n">Discount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">get_discount</span><span class="p" data-group-id="5167140400-11">(</span><span class="n">Customer</span><span class="p" data-group-id="5167140400-11">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="5167140400-12">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5167140400-13">#{</span><span class="ss">price</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">BasePrice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p" data-group-id="5167140400-14">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Discount</span><span class="p" data-group-id="5167140400-14">)</span><span class="p" data-group-id="5167140400-13">}</span><span class="p" data-group-id="5167140400-12">}</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Service consumer</span><span class="w">
</span><span class="nf">get_order_total</span><span class="p" data-group-id="5167140400-15">(</span><span class="n">Items</span><span class="p">,</span><span class="w"> </span><span class="n">Customer</span><span class="p" data-group-id="5167140400-15">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5167140400-16">#{</span><span class="ss">items</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Items</span><span class="p">,</span><span class="w"> </span><span class="ss">customer</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Customer</span><span class="p" data-group-id="5167140400-16">}</span><span class="p">,</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="5167140400-17">(</span><span class="p" data-group-id="5167140400-18">&lt;&lt;</span><span class="s">&quot;pricing.calculate&quot;</span><span class="p" data-group-id="5167140400-18">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Request</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="5167140400-17">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="5167140400-19">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5167140400-20">#{</span><span class="ss">price</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Price</span><span class="p" data-group-id="5167140400-20">}</span><span class="p" data-group-id="5167140400-19">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="5167140400-21">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Price</span><span class="p" data-group-id="5167140400-21">}</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="5167140400-22">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">timeout</span><span class="p" data-group-id="5167140400-22">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="5167140400-23">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">pricing_unavailable</span><span class="p" data-group-id="5167140400-23">}</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span></code></pre><p><strong>Routing strategies:</strong></p><ul><li>DHT-based service discovery</li><li>Load balancing across providers</li><li>Automatic failover</li></ul><h3 id="pattern-3-discovery" class="section-heading"><a href="#pattern-3-discovery" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Pattern 3: Discovery</span></h3><p>Dynamic service and peer discovery:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Find services</span><span class="w">
</span><span class="p" data-group-id="8713139200-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Services</span><span class="p" data-group-id="8713139200-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">discover</span><span class="p" data-group-id="8713139200-2">(</span><span class="p" data-group-id="8713139200-3">&lt;&lt;</span><span class="s">&quot;pricing.*&quot;</span><span class="p" data-group-id="8713139200-3">&gt;&gt;</span><span class="p" data-group-id="8713139200-2">)</span><span class="p">,</span><span class="w">
</span><span class="c1">%% Returns: [&lt;&lt;&quot;pricing.calculate&quot;&gt;&gt;, &lt;&lt;&quot;pricing.convert&quot;&gt;&gt;]</span><span class="w">

</span><span class="c1">%% Find peers</span><span class="w">
</span><span class="n">Peers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">peers</span><span class="p" data-group-id="8713139200-4">(</span><span class="p" data-group-id="8713139200-4">)</span><span class="p">,</span><span class="w">
</span><span class="c1">%% Returns: [&lt;&lt;&quot;abc123...&quot;&gt;&gt;, &lt;&lt;&quot;def456...&quot;&gt;&gt;]</span><span class="w">

</span><span class="c1">%% Get local node ID</span><span class="w">
</span><span class="n">NodeId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">node_id</span><span class="p" data-group-id="8713139200-5">(</span><span class="p" data-group-id="8713139200-5">)</span><span class="p">,</span><span class="w">
</span><span class="c1">%% Returns: &lt;&lt;&quot;789xyz...&quot;&gt;&gt;</span></code></pre><hr class="thin"/><h2 id="best-practices" class="section-heading"><a href="#best-practices" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Best Practices</span></h2><h3 id="1-design-for-failure" class="section-heading"><a href="#1-design-for-failure" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">1. Design for Failure</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Good: Handle failures gracefully</span><span class="w">
</span><span class="nf">process_order</span><span class="p" data-group-id="8294446612-1">(</span><span class="n">Order</span><span class="p" data-group-id="8294446612-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="8294446612-2">(</span><span class="p" data-group-id="8294446612-3">&lt;&lt;</span><span class="s">&quot;inventory.check&quot;</span><span class="p" data-group-id="8294446612-3">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p">,</span><span class="w"> </span><span class="mi">3000</span><span class="p" data-group-id="8294446612-2">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="8294446612-4">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Available</span><span class="p" data-group-id="8294446612-4">}</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">Available</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nf">proceed_with_order</span><span class="p" data-group-id="8294446612-5">(</span><span class="n">Order</span><span class="p" data-group-id="8294446612-5">)</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="8294446612-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="n">NotAvailable</span><span class="p" data-group-id="8294446612-6">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="8294446612-7">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">out_of_stock</span><span class="p" data-group-id="8294446612-7">}</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="8294446612-8">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">timeout</span><span class="p" data-group-id="8294446612-8">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="c1">%% Retry or use cached data</span><span class="w">
            </span><span class="nf">check_cached_inventory</span><span class="p" data-group-id="8294446612-9">(</span><span class="n">Order</span><span class="p" data-group-id="8294446612-9">)</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Bad: Assume success</span><span class="w">
</span><span class="nf">process_order</span><span class="p" data-group-id="8294446612-10">(</span><span class="n">Order</span><span class="p" data-group-id="8294446612-10">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="8294446612-11">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Available</span><span class="p" data-group-id="8294446612-11">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="8294446612-12">(</span><span class="p" data-group-id="8294446612-13">&lt;&lt;</span><span class="s">&quot;inventory.check&quot;</span><span class="p" data-group-id="8294446612-13">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="8294446612-12">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">proceed_with_order</span><span class="p" data-group-id="8294446612-14">(</span><span class="n">Order</span><span class="p" data-group-id="8294446612-14">)</span><span class="p">.</span></code></pre><h3 id="2-use-meaningful-topics" class="section-heading"><a href="#2-use-meaningful-topics" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">2. Use Meaningful Topics</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Good: Business-meaningful topics</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="1681206013-1">(</span><span class="p" data-group-id="1681206013-2">&lt;&lt;</span><span class="s">&quot;orders.confirmed&quot;</span><span class="p" data-group-id="1681206013-2">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="1681206013-1">)</span><span class="p">,</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="1681206013-3">(</span><span class="p" data-group-id="1681206013-4">&lt;&lt;</span><span class="s">&quot;inventory.depleted&quot;</span><span class="p" data-group-id="1681206013-4">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Item</span><span class="p" data-group-id="1681206013-3">)</span><span class="p">,</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="1681206013-5">(</span><span class="p" data-group-id="1681206013-6">&lt;&lt;</span><span class="s">&quot;payment.captured&quot;</span><span class="p" data-group-id="1681206013-6">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Payment</span><span class="p" data-group-id="1681206013-5">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Bad: Generic/technical topics</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="1681206013-7">(</span><span class="p" data-group-id="1681206013-8">&lt;&lt;</span><span class="s">&quot;event&quot;</span><span class="p" data-group-id="1681206013-8">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1681206013-9">#{</span><span class="ss">type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">order_confirmed</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="1681206013-9">}</span><span class="p" data-group-id="1681206013-7">)</span><span class="p">,</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="1681206013-10">(</span><span class="p" data-group-id="1681206013-11">&lt;&lt;</span><span class="s">&quot;update&quot;</span><span class="p" data-group-id="1681206013-11">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1681206013-12">#{</span><span class="ss">entity</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">inventory</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="1681206013-12">}</span><span class="p" data-group-id="1681206013-10">)</span><span class="p">.</span></code></pre><h3 id="3-keep-payloads-small" class="section-heading"><a href="#3-keep-payloads-small" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">3. Keep Payloads Small</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Good: Reference large data</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="0046406551-1">(</span><span class="p" data-group-id="0046406551-2">&lt;&lt;</span><span class="s">&quot;documents.uploaded&quot;</span><span class="p" data-group-id="0046406551-2">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0046406551-3">#{</span><span class="w">
    </span><span class="ss">document_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">DocId</span><span class="p">,</span><span class="w">
    </span><span class="ss">storage_url</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Url</span><span class="p">,</span><span class="w">
    </span><span class="ss">size_bytes</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Size</span><span class="w">
</span><span class="p" data-group-id="0046406551-3">}</span><span class="p" data-group-id="0046406551-1">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Bad: Embed large data</span><span class="w">
</span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="0046406551-4">(</span><span class="p" data-group-id="0046406551-5">&lt;&lt;</span><span class="s">&quot;documents.uploaded&quot;</span><span class="p" data-group-id="0046406551-5">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0046406551-6">#{</span><span class="w">
    </span><span class="ss">document_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">DocId</span><span class="p">,</span><span class="w">
    </span><span class="ss">content</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">LargeBinaryData</span><span class="w">  </span><span class="c1">%% Don&#39;t do this!</span><span class="w">
</span><span class="p" data-group-id="0046406551-6">}</span><span class="p" data-group-id="0046406551-4">)</span><span class="p">.</span></code></pre><h3 id="4-scope-by-realm" class="section-heading"><a href="#4-scope-by-realm" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">4. Scope by Realm</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Production</span><span class="w">
</span><span class="p" data-group-id="1051551619-1">{</span><span class="ss">macula</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1051551619-2">[</span><span class="p" data-group-id="1051551619-3">{</span><span class="ss">realm</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1051551619-4">&lt;&lt;</span><span class="s">&quot;com.example.prod&quot;</span><span class="p" data-group-id="1051551619-4">&gt;&gt;</span><span class="p" data-group-id="1051551619-3">}</span><span class="p" data-group-id="1051551619-2">]</span><span class="p" data-group-id="1051551619-1">}</span><span class="w">

</span><span class="c1">%% Staging</span><span class="w">
</span><span class="p" data-group-id="1051551619-5">{</span><span class="ss">macula</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1051551619-6">[</span><span class="p" data-group-id="1051551619-7">{</span><span class="ss">realm</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1051551619-8">&lt;&lt;</span><span class="s">&quot;com.example.staging&quot;</span><span class="p" data-group-id="1051551619-8">&gt;&gt;</span><span class="p" data-group-id="1051551619-7">}</span><span class="p" data-group-id="1051551619-6">]</span><span class="p" data-group-id="1051551619-5">}</span><span class="w">

</span><span class="c1">%% Development</span><span class="w">
</span><span class="p" data-group-id="1051551619-9">{</span><span class="ss">macula</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1051551619-10">[</span><span class="p" data-group-id="1051551619-11">{</span><span class="ss">realm</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1051551619-12">&lt;&lt;</span><span class="s">&quot;com.example.dev&quot;</span><span class="p" data-group-id="1051551619-12">&gt;&gt;</span><span class="p" data-group-id="1051551619-11">}</span><span class="p" data-group-id="1051551619-10">]</span><span class="p" data-group-id="1051551619-9">}</span></code></pre><h3 id="5-monitor-health" class="section-heading"><a href="#5-monitor-health" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">5. Monitor Health</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Periodic health check</span><span class="w">
</span><span class="nf">check_platform_health</span><span class="p" data-group-id="2833042759-1">(</span><span class="p" data-group-id="2833042759-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">health</span><span class="p" data-group-id="2833042759-2">(</span><span class="p" data-group-id="2833042759-2">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="2833042759-3">#{</span><span class="ss">status</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="ss">ok</span><span class="p" data-group-id="2833042759-3">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">ok</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="2833042759-4">#{</span><span class="ss">status</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="ss">degraded</span><span class="p">,</span><span class="w"> </span><span class="ss">reason</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="2833042759-4">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">logger</span><span class="p">:</span><span class="nf">warning</span><span class="p" data-group-id="2833042759-5">(</span><span class="s">&quot;Macula degraded: </span><span class="si">~p</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2833042759-6">[</span><span class="n">Reason</span><span class="p" data-group-id="2833042759-6">]</span><span class="p" data-group-id="2833042759-5">)</span><span class="p">,</span><span class="w">
            </span><span class="nf">alert_ops</span><span class="p" data-group-id="2833042759-7">(</span><span class="n">Reason</span><span class="p" data-group-id="2833042759-7">)</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span></code></pre><hr class="thin"/><h2 id="example-complete-lob-application" class="section-heading"><a href="#example-complete-lob-application" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example: Complete LoB Application</span></h2><p>Here's a complete example of an order processing service:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="3071859212-1">(</span><span class="ss">order_service</span><span class="p" data-group-id="3071859212-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">behaviour</span><span class="p" data-group-id="3071859212-2">(</span><span class="ss">gen_server</span><span class="p" data-group-id="3071859212-2">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%% API</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="3071859212-3">(</span><span class="p" data-group-id="3071859212-4">[</span><span class="ss">start_link</span><span class="p">/</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="ss">create_order</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="3071859212-4">]</span><span class="p" data-group-id="3071859212-3">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%% gen_server callbacks</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="3071859212-5">(</span><span class="p" data-group-id="3071859212-6">[</span><span class="ss">init</span><span class="p">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">handle_call</span><span class="p">/</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="ss">handle_cast</span><span class="p">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="ss">handle_info</span><span class="p">/</span><span class="mi">2</span><span class="p" data-group-id="3071859212-6">]</span><span class="p" data-group-id="3071859212-5">)</span><span class="p">.</span><span class="w">
</span><span class="w">
</span><span class="p">-</span><span class="na">record</span><span class="p" data-group-id="3071859212-7">(</span><span class="ss">state</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-8">{</span><span class="w">
    </span><span class="ss">pending_orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="3071859212-9">#{</span><span class="p" data-group-id="3071859212-9">}</span><span class="w">
</span><span class="p" data-group-id="3071859212-8">}</span><span class="p" data-group-id="3071859212-7">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%%====================================================================</span><span class="w">
</span><span class="c1">%% API</span><span class="w">
</span><span class="c1">%%====================================================================</span><span class="w">

</span><span class="nf">start_link</span><span class="p" data-group-id="3071859212-10">(</span><span class="p" data-group-id="3071859212-10">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">gen_server</span><span class="p">:</span><span class="nf">start_link</span><span class="p" data-group-id="3071859212-11">(</span><span class="p" data-group-id="3071859212-12">{</span><span class="ss">local</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">MODULE</span><span class="p" data-group-id="3071859212-12">}</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">MODULE</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-13">[</span><span class="p" data-group-id="3071859212-13">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-14">[</span><span class="p" data-group-id="3071859212-14">]</span><span class="p" data-group-id="3071859212-11">)</span><span class="p">.</span><span class="w">

</span><span class="nf">create_order</span><span class="p" data-group-id="3071859212-15">(</span><span class="n">OrderData</span><span class="p" data-group-id="3071859212-15">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">gen_server</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="3071859212-16">(</span><span class="o">?</span><span class="n">MODULE</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-17">{</span><span class="ss">create_order</span><span class="p">,</span><span class="w"> </span><span class="n">OrderData</span><span class="p" data-group-id="3071859212-17">}</span><span class="p" data-group-id="3071859212-16">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%%====================================================================</span><span class="w">
</span><span class="c1">%% gen_server callbacks</span><span class="w">
</span><span class="c1">%%====================================================================</span><span class="w">

</span><span class="nf">init</span><span class="p" data-group-id="3071859212-18">(</span><span class="p" data-group-id="3071859212-19">[</span><span class="p" data-group-id="3071859212-19">]</span><span class="p" data-group-id="3071859212-18">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Subscribe to relevant events</span><span class="w">
    </span><span class="p" data-group-id="3071859212-20">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="3071859212-20">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">subscribe</span><span class="p" data-group-id="3071859212-21">(</span><span class="p" data-group-id="3071859212-22">&lt;&lt;</span><span class="s">&quot;payments.captured&quot;</span><span class="p" data-group-id="3071859212-22">&gt;&gt;</span><span class="p">,</span><span class="w">
                               </span><span class="nf">fun</span><span class="p" data-group-id="3071859212-23">(</span><span class="n">Msg</span><span class="p" data-group-id="3071859212-23">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="o">?</span><span class="n">MODULE</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="3071859212-24">{</span><span class="ss">payment</span><span class="p">,</span><span class="w"> </span><span class="n">Msg</span><span class="p" data-group-id="3071859212-24">}</span><span class="w"> </span><span class="k">end</span><span class="p" data-group-id="3071859212-21">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3071859212-25">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="3071859212-25">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">subscribe</span><span class="p" data-group-id="3071859212-26">(</span><span class="p" data-group-id="3071859212-27">&lt;&lt;</span><span class="s">&quot;inventory.reserved&quot;</span><span class="p" data-group-id="3071859212-27">&gt;&gt;</span><span class="p">,</span><span class="w">
                               </span><span class="nf">fun</span><span class="p" data-group-id="3071859212-28">(</span><span class="n">Msg</span><span class="p" data-group-id="3071859212-28">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="o">?</span><span class="n">MODULE</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="3071859212-29">{</span><span class="ss">inventory</span><span class="p">,</span><span class="w"> </span><span class="n">Msg</span><span class="p" data-group-id="3071859212-29">}</span><span class="w"> </span><span class="k">end</span><span class="p" data-group-id="3071859212-26">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% Advertise our services</span><span class="w">
    </span><span class="p" data-group-id="3071859212-30">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="3071859212-30">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">advertise</span><span class="p" data-group-id="3071859212-31">(</span><span class="p" data-group-id="3071859212-32">&lt;&lt;</span><span class="s">&quot;orders.create&quot;</span><span class="p" data-group-id="3071859212-32">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="ss">handle_create</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="3071859212-31">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3071859212-33">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="3071859212-33">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">advertise</span><span class="p" data-group-id="3071859212-34">(</span><span class="p" data-group-id="3071859212-35">&lt;&lt;</span><span class="s">&quot;orders.status&quot;</span><span class="p" data-group-id="3071859212-35">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="ss">handle_status</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="3071859212-34">)</span><span class="p">,</span><span class="w">

    </span><span class="p" data-group-id="3071859212-36">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">state</span><span class="p" data-group-id="3071859212-37">{</span><span class="p" data-group-id="3071859212-37">}</span><span class="p" data-group-id="3071859212-36">}</span><span class="p">.</span><span class="w">

</span><span class="nf">handle_call</span><span class="p" data-group-id="3071859212-38">(</span><span class="p" data-group-id="3071859212-39">{</span><span class="ss">create_order</span><span class="p">,</span><span class="w"> </span><span class="n">OrderData</span><span class="p" data-group-id="3071859212-39">}</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="n">From</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-38">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Validate order</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nf">validate_order</span><span class="p" data-group-id="3071859212-40">(</span><span class="n">OrderData</span><span class="p" data-group-id="3071859212-40">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="3071859212-41">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="3071859212-41">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="c1">%% Check inventory via RPC</span><span class="w">
            </span><span class="k">case</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="3071859212-42">(</span><span class="p" data-group-id="3071859212-43">&lt;&lt;</span><span class="s">&quot;inventory.check&quot;</span><span class="p" data-group-id="3071859212-43">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="3071859212-42">)</span><span class="w"> </span><span class="k">of</span><span class="w">
                </span><span class="p" data-group-id="3071859212-44">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-45">#{</span><span class="ss">available</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="3071859212-45">}</span><span class="p" data-group-id="3071859212-44">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                    </span><span class="c1">%% Reserve inventory</span><span class="w">
                    </span><span class="p" data-group-id="3071859212-46">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="3071859212-46">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="3071859212-47">(</span><span class="p" data-group-id="3071859212-48">&lt;&lt;</span><span class="s">&quot;inventory.reserve&quot;</span><span class="p" data-group-id="3071859212-48">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="3071859212-47">)</span><span class="p">,</span><span class="w">

                    </span><span class="c1">%% Process payment</span><span class="w">
                    </span><span class="p" data-group-id="3071859212-49">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="3071859212-49">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="3071859212-50">(</span><span class="p" data-group-id="3071859212-51">&lt;&lt;</span><span class="s">&quot;payments.charge&quot;</span><span class="p" data-group-id="3071859212-51">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p" data-group-id="3071859212-50">)</span><span class="p">,</span><span class="w">

                    </span><span class="c1">%% Publish order created event</span><span class="w">
                    </span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="3071859212-52">(</span><span class="p" data-group-id="3071859212-53">&lt;&lt;</span><span class="s">&quot;orders.created&quot;</span><span class="p" data-group-id="3071859212-53">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="3071859212-52">)</span><span class="p">,</span><span class="w">

                    </span><span class="c1">%% Store pending order</span><span class="w">
                    </span><span class="n">NewState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">store_pending</span><span class="p" data-group-id="3071859212-54">(</span><span class="n">Order</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-54">)</span><span class="p">,</span><span class="w">
                    </span><span class="p" data-group-id="3071859212-55">{</span><span class="ss">reply</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-56">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="o">#</span><span class="ss">order</span><span class="p">.</span><span class="ss">id</span><span class="p" data-group-id="3071859212-56">}</span><span class="p">,</span><span class="w"> </span><span class="n">NewState</span><span class="p" data-group-id="3071859212-55">}</span><span class="p">;</span><span class="w">

                </span><span class="p" data-group-id="3071859212-57">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-58">#{</span><span class="ss">available</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="3071859212-58">}</span><span class="p" data-group-id="3071859212-57">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                    </span><span class="p" data-group-id="3071859212-59">{</span><span class="ss">reply</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-60">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">out_of_stock</span><span class="p" data-group-id="3071859212-60">}</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-59">}</span><span class="p">;</span><span class="w">

                </span><span class="p" data-group-id="3071859212-61">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="3071859212-61">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                    </span><span class="p" data-group-id="3071859212-62">{</span><span class="ss">reply</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-63">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="3071859212-63">}</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-62">}</span><span class="w">
            </span><span class="k">end</span><span class="p">;</span><span class="w">

        </span><span class="p" data-group-id="3071859212-64">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="3071859212-64">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="3071859212-65">{</span><span class="ss">reply</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-66">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="3071859212-66">}</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-65">}</span><span class="w">
    </span><span class="k">end</span><span class="p">;</span><span class="w">

</span><span class="nf">handle_call</span><span class="p" data-group-id="3071859212-67">(</span><span class="p">_</span><span class="n">Request</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="n">From</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-67">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="3071859212-68">{</span><span class="ss">reply</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-69">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">unknown_request</span><span class="p" data-group-id="3071859212-69">}</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-68">}</span><span class="p">.</span><span class="w">

</span><span class="nf">handle_cast</span><span class="p" data-group-id="3071859212-70">(</span><span class="p">_</span><span class="n">Msg</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-70">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="3071859212-71">{</span><span class="ss">noreply</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-71">}</span><span class="p">.</span><span class="w">

</span><span class="nf">handle_info</span><span class="p" data-group-id="3071859212-72">(</span><span class="p" data-group-id="3071859212-73">{</span><span class="ss">payment</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-74">#{</span><span class="ss">payload</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Payment</span><span class="p" data-group-id="3071859212-74">}</span><span class="p" data-group-id="3071859212-73">}</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-72">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Payment captured, confirm order</span><span class="w">
    </span><span class="n">OrderId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">maps</span><span class="p">:</span><span class="nf">get</span><span class="p" data-group-id="3071859212-75">(</span><span class="ss">order_id</span><span class="p">,</span><span class="w"> </span><span class="n">Payment</span><span class="p" data-group-id="3071859212-75">)</span><span class="p">,</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nf">get_pending</span><span class="p" data-group-id="3071859212-76">(</span><span class="n">OrderId</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-76">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="3071859212-77">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="3071859212-77">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="c1">%% Publish confirmed event</span><span class="w">
            </span><span class="nc">macula</span><span class="p">:</span><span class="nf">publish</span><span class="p" data-group-id="3071859212-78">(</span><span class="p" data-group-id="3071859212-79">&lt;&lt;</span><span class="s">&quot;orders.confirmed&quot;</span><span class="p" data-group-id="3071859212-79">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="3071859212-78">)</span><span class="p">,</span><span class="w">

            </span><span class="c1">%% Request shipment</span><span class="w">
            </span><span class="nc">macula</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="3071859212-80">(</span><span class="p" data-group-id="3071859212-81">&lt;&lt;</span><span class="s">&quot;shipping.schedule&quot;</span><span class="p" data-group-id="3071859212-81">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="3071859212-80">)</span><span class="p">,</span><span class="w">

            </span><span class="n">NewState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">remove_pending</span><span class="p" data-group-id="3071859212-82">(</span><span class="n">OrderId</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-82">)</span><span class="p">,</span><span class="w">
            </span><span class="p" data-group-id="3071859212-83">{</span><span class="ss">noreply</span><span class="p">,</span><span class="w"> </span><span class="n">NewState</span><span class="p" data-group-id="3071859212-83">}</span><span class="p">;</span><span class="w">

        </span><span class="ss">not_found</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="3071859212-84">{</span><span class="ss">noreply</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-84">}</span><span class="w">
    </span><span class="k">end</span><span class="p">;</span><span class="w">

</span><span class="nf">handle_info</span><span class="p" data-group-id="3071859212-85">(</span><span class="p" data-group-id="3071859212-86">{</span><span class="ss">inventory</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-87">#{</span><span class="ss">payload</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Reservation</span><span class="p" data-group-id="3071859212-87">}</span><span class="p" data-group-id="3071859212-86">}</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-85">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Inventory reserved, continue processing</span><span class="w">
    </span><span class="nc">logger</span><span class="p">:</span><span class="nf">info</span><span class="p" data-group-id="3071859212-88">(</span><span class="s">&quot;Inventory reserved: </span><span class="si">~p</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-89">[</span><span class="n">Reservation</span><span class="p" data-group-id="3071859212-89">]</span><span class="p" data-group-id="3071859212-88">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3071859212-90">{</span><span class="ss">noreply</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-90">}</span><span class="p">;</span><span class="w">

</span><span class="nf">handle_info</span><span class="p" data-group-id="3071859212-91">(</span><span class="p">_</span><span class="n">Info</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-91">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="3071859212-92">{</span><span class="ss">noreply</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-92">}</span><span class="p">.</span><span class="w">

</span><span class="c1">%%====================================================================</span><span class="w">
</span><span class="c1">%% Internal functions</span><span class="w">
</span><span class="c1">%%====================================================================</span><span class="w">

</span><span class="nf">handle_create</span><span class="p" data-group-id="3071859212-93">(</span><span class="n">Request</span><span class="p" data-group-id="3071859212-93">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">gen_server</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="3071859212-94">(</span><span class="o">?</span><span class="n">MODULE</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3071859212-95">{</span><span class="ss">create_order</span><span class="p">,</span><span class="w"> </span><span class="n">Request</span><span class="p" data-group-id="3071859212-95">}</span><span class="p" data-group-id="3071859212-94">)</span><span class="p">.</span><span class="w">

</span><span class="nf">handle_status</span><span class="p" data-group-id="3071859212-96">(</span><span class="p" data-group-id="3071859212-97">#{</span><span class="ss">order_id</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">OrderId</span><span class="p" data-group-id="3071859212-97">}</span><span class="p" data-group-id="3071859212-96">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Return order status</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nf">get_order</span><span class="p" data-group-id="3071859212-98">(</span><span class="n">OrderId</span><span class="p" data-group-id="3071859212-98">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="3071859212-99">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="3071859212-99">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="3071859212-100">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="3071859212-100">}</span><span class="p">;</span><span class="w">
        </span><span class="ss">not_found</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="3071859212-101">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">not_found</span><span class="p" data-group-id="3071859212-101">}</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="nf">validate_order</span><span class="p" data-group-id="3071859212-102">(</span><span class="n">Data</span><span class="p" data-group-id="3071859212-102">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Validation logic</span><span class="w">
    </span><span class="p" data-group-id="3071859212-103">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">order</span><span class="p" data-group-id="3071859212-104">{</span><span class="ss">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">generate_id</span><span class="p" data-group-id="3071859212-105">(</span><span class="p" data-group-id="3071859212-105">)</span><span class="p">,</span><span class="w"> </span><span class="ss">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Data</span><span class="p" data-group-id="3071859212-104">}</span><span class="p" data-group-id="3071859212-103">}</span><span class="p">.</span><span class="w">

</span><span class="nf">store_pending</span><span class="p" data-group-id="3071859212-106">(</span><span class="n">Order</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">state</span><span class="p" data-group-id="3071859212-107">{</span><span class="ss">pending_orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pending</span><span class="p" data-group-id="3071859212-107">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-106">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">State</span><span class="o">#</span><span class="ss">state</span><span class="p" data-group-id="3071859212-108">{</span><span class="ss">pending_orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pending</span><span class="p" data-group-id="3071859212-109">#{</span><span class="n">Order</span><span class="o">#</span><span class="ss">order</span><span class="p">.</span><span class="ss">id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="3071859212-109">}</span><span class="p" data-group-id="3071859212-108">}</span><span class="p">.</span><span class="w">

</span><span class="nf">get_pending</span><span class="p" data-group-id="3071859212-110">(</span><span class="n">OrderId</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">state</span><span class="p" data-group-id="3071859212-111">{</span><span class="ss">pending_orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pending</span><span class="p" data-group-id="3071859212-111">}</span><span class="p" data-group-id="3071859212-110">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">maps</span><span class="p">:</span><span class="nf">get</span><span class="p" data-group-id="3071859212-112">(</span><span class="n">OrderId</span><span class="p">,</span><span class="w"> </span><span class="n">Pending</span><span class="p">,</span><span class="w"> </span><span class="ss">not_found</span><span class="p" data-group-id="3071859212-112">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="ss">not_found</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">not_found</span><span class="p">;</span><span class="w">
        </span><span class="n">Order</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="3071859212-113">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="p" data-group-id="3071859212-113">}</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="nf">remove_pending</span><span class="p" data-group-id="3071859212-114">(</span><span class="n">OrderId</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">state</span><span class="p" data-group-id="3071859212-115">{</span><span class="ss">pending_orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pending</span><span class="p" data-group-id="3071859212-115">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">State</span><span class="p" data-group-id="3071859212-114">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">State</span><span class="o">#</span><span class="ss">state</span><span class="p" data-group-id="3071859212-116">{</span><span class="ss">pending_orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">maps</span><span class="p">:</span><span class="nf">remove</span><span class="p" data-group-id="3071859212-117">(</span><span class="n">OrderId</span><span class="p">,</span><span class="w"> </span><span class="n">Pending</span><span class="p" data-group-id="3071859212-117">)</span><span class="p" data-group-id="3071859212-116">}</span><span class="p">.</span><span class="w">

</span><span class="nf">get_order</span><span class="p" data-group-id="3071859212-118">(</span><span class="n">OrderId</span><span class="p" data-group-id="3071859212-118">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Database lookup</span><span class="w">
    </span><span class="p" data-group-id="3071859212-119">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">order</span><span class="p" data-group-id="3071859212-120">{</span><span class="ss">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OrderId</span><span class="p" data-group-id="3071859212-120">}</span><span class="p" data-group-id="3071859212-119">}</span><span class="p">.</span><span class="w">

</span><span class="nf">generate_id</span><span class="p" data-group-id="3071859212-121">(</span><span class="p" data-group-id="3071859212-121">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">base64</span><span class="p">:</span><span class="nf">encode</span><span class="p" data-group-id="3071859212-122">(</span><span class="nc">crypto</span><span class="p">:</span><span class="nf">strong_rand_bytes</span><span class="p" data-group-id="3071859212-123">(</span><span class="mi">16</span><span class="p" data-group-id="3071859212-123">)</span><span class="p" data-group-id="3071859212-122">)</span><span class="p">.</span></code></pre><hr class="thin"/><h2 id="future-directions" class="section-heading"><a href="#future-directions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Future Directions</span></h2><h3 id="v0-9-0-nat-traversal" class="section-heading"><a href="#v0-9-0-nat-traversal" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">v0.9.0: NAT Traversal</span></h3><p>Direct P2P connections between peers behind NAT:</p><ul><li>STUN/TURN/ICE-like connectivity</li><li>95% direct connections</li><li>5% relay fallback</li></ul><h3 id="v1-0-0-production-ready" class="section-heading"><a href="#v1-0-0-production-ready" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">v1.0.0: Production Ready</span></h3><p>Full platform stability:</p><ul><li>Comprehensive monitoring</li><li>Horizontal scaling</li><li>Geographic distribution</li><li>Enterprise features</li></ul><h3 id="beyond-v1-0-0" class="section-heading"><a href="#beyond-v1-0-0" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Beyond v1.0.0</span></h3><ul><li><strong>Persistent streams</strong> - Long-lived data channels</li><li><strong>Consensus</strong> - Distributed agreement protocols</li><li><strong>Storage</strong> - Integrated distributed storage</li><li><strong>Compute</strong> - Edge function execution</li></ul><hr class="thin"/><h2 id="summary" class="section-heading"><a href="#summary" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Summary</span></h2><p>Macula is a <strong>distributed application platform</strong> that provides:</p><table><thead><tr><th style="text-align: left;">Capability</th><th style="text-align: left;">Description</th></tr></thead><tbody><tr><td style="text-align: left;"><strong>Mesh Networking</strong></td><td style="text-align: left;">HTTP/3 (QUIC) transport with DHT routing</td></tr><tr><td style="text-align: left;"><strong>Pub/Sub</strong></td><td style="text-align: left;">Event-driven messaging with wildcards</td></tr><tr><td style="text-align: left;"><strong>RPC</strong></td><td style="text-align: left;">Service discovery and remote calls</td></tr><tr><td style="text-align: left;"><strong>Multi-Tenancy</strong></td><td style="text-align: left;">Realm-based isolation</td></tr><tr><td style="text-align: left;"><strong>Zero-Config</strong></td><td style="text-align: left;">Auto TLS, stable Node IDs</td></tr><tr><td style="text-align: left;"><strong>Fault Tolerance</strong></td><td style="text-align: left;">OTP supervision, automatic recovery</td></tr></tbody></table><p><strong>Platform Benefits:</strong></p><ul><li>Clean separation between infrastructure and business logic</li><li>Simple SDK API for applications</li><li>Independent deployment and scaling</li><li>Support for LoB, IoT, and TWEANN workloads</li></ul><p><strong>Vision:</strong> A decentralized, self-organizing mesh that enables distributed applications to communicate seamlessly across network boundaries.</p><hr class="thin"/><h2 id="related-documents" class="section-heading"><a href="#related-documents" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Related Documents</span></h2><ul><li><a href="getting_started.html">Getting Started</a> - Quick start guide</li><li><a href="architecture.html">Architecture Overview</a> - Technical architecture</li><li><a href="full_supervision_tree.html">Supervision Tree</a> - OTP process hierarchy</li><li><a href="readme.html">Memory Management</a> - Resource management</li><li><a href="changelog.html">v0.8.5 Release</a> - Latest release notes</li></ul>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="readme.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Overview
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="getting_started.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Getting Started
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/macula/0.8.6" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/macula/0.8.6">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/macula/0.8.6/show/architecture/PLATFORM_VISION.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="macula.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
